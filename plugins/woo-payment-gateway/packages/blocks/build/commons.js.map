{"version":3,"sources":["webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/assertThisInitialized.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/asyncToGenerator.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/construct.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/createClass.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/extends.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/getPrototypeOf.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/inherits.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/interopRequireDefault.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/isNativeFunction.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/isNativeReflectConstruct.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/objectWithoutProperties.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/typeof.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack://wcBraintree.[name]/./node_modules/@babel/runtime/helpers/wrapNativeSuper.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/components/error-boundary/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/components/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/components/notice/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/components/payment-method-label/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/components/payment-method/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/components/saved-token-component/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/applepay/hooks/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/applepay/hooks/use-create-payment-request.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/applepay/hooks/use-create-session.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/applepay/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/applepay/utils.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/context/action-emitter.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/context/action-reducer.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/context/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/context/payment-context.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/credit-card/custom-form/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/credit-card/custom-form/registry.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/credit-card/custom-forms/bootstrap/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/credit-card/custom-forms/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/credit-card/dropin-form/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/credit-card/hosted-fields/card-cvv.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/credit-card/hosted-fields/card-expiration-date.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/credit-card/hosted-fields/card-number.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/credit-card/hosted-fields/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/credit-card/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/googlepay/helpers.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/googlepay/hooks/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/googlepay/hooks/use-create-payments-client.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/googlepay/hooks/use-handle-tokenization.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/googlepay/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/hooks/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/hooks/use-breakpoint-width.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/hooks/use-device-data.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/hooks/use-notice-handler.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/hooks/use-payment-events-handler.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/hooks/use-process-payment-failure.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/hooks/use-process-payment.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/hooks/use-three-d-secure.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/paypal/hooks/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/paypal/hooks/use-load-paypal.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/paypal/hooks/use-paypal-options.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/paypal/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/utils.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/venmo/hooks/index.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/venmo/hooks/use-handle-tokenization.js","webpack://wcBraintree.[name]/./packages/blocks/assets/js/payment-methods/venmo/index.js","webpack://wcBraintree.[name]/./node_modules/classnames/index.js"],"names":["module","exports","arr","len","length","i","arr2","Array","isArray","arrayLikeToArray","self","ReferenceError","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","fn","this","args","arguments","apply","err","undefined","instance","Constructor","TypeError","setPrototypeOf","isNativeReflectConstruct","_construct","Parent","Class","Reflect","construct","a","push","Function","bind","prototype","_defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","protoProps","staticProps","obj","_extends","assign","source","hasOwnProperty","call","_getPrototypeOf","o","getPrototypeOf","__proto__","subClass","superClass","create","constructor","__esModule","toString","indexOf","sham","Proxy","Date","e","iter","Symbol","iterator","from","_arr","_n","_d","_e","_s","_i","next","objectWithoutPropertiesLoose","excluded","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","sourceKeys","keys","_typeof","assertThisInitialized","_setPrototypeOf","p","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","arrayWithoutHoles","iterableToArray","nonIterableSpread","minLen","n","slice","name","test","isNativeFunction","_wrapNativeSuper","_cache","Map","has","get","set","Wrapper","state","hasError","errorInfo","setState","className","componentStack","children","Component","Notice","notice","onRemove","classes","type","isDismissible","message","PaymentMethodLabel","title","components","paymentMethod","icon","Label","Icons","PaymentMethodIcons","text","icons","align","PaymentMethod","content","description","el","useRef","useState","container","setContainer","Content","useEffect","current","ref","PaymentMethodDataProvider","PaymentMethodProviderContainer","billing","shippingData","eventRegistration","emitResponse","activePaymentMethod","isExpress","advancedFraudOptions","onPaymentProcessing","onCheckoutAfterProcessingWithError","responseTypes","noticeContexts","useProcessPayment","useProcessPaymentFailure","event","messageContext","EXPRESS_PAYMENTS","SavedTokenComponent","vaultedThreeDSecure","token","currentData","doPaymentDataFilter","usePaymentMethodDataContext","useDeviceData","useThreeDSecure","fetchTokenNonce","useCallback","token_id","path","method","data","version","result","unsubscribe","success","BraintreeError","meta","paymentMethodData","ensureSuccessResponse","ensureErrorResponse","useCreatePaymentRequest","applePayInstance","getData","useMemo","cartTotal","currency","cartTotalItems","billingData","needsShipping","shippingRates","request","total","label","amount","removeNumberPrecision","minorUnit","lineItems","formatLineItems","currencyCode","code","countryCode","requiredBillingContactFields","requiredShippingContactFields","fields","email","phone","shippingMethods","formatShippingMethods","createPaymentRequest","useCreateSession","paymentRequest","onClick","addShippingHandler","usePaymentEventsHandler","setPaymentMethodNonce","onPaymentDataFilter","addNotice","applePayData","getApplePayVersion","range","ApplePaySession","supportsVersion","onValidateMerchant","session","performValidation","validationURL","displayName","merchantSession","completeMerchantValidation","catch","abort","onPaymentMethodSelected","address","billingContact","country","administrativeArea","postcode","postalCode","city","locality","url","response","messages","completePaymentMethodSelection","xhr","onShippingContactSelected","shippingContact","shippingAddress","setShippingAddress","newAddress","toUpperCase","updateData","selectedRates","newTotal","newLineItems","newShippingMethods","errors","identifier","__","detail","ApplePayError","completeShippingContactSelection","isEqual","onShippingMethodSelected","shippingMethod","setSelectedRates","isRateEqual","getSelectedShippingOptionId","extractSelectedShippingOption","completeShippingMethodSelection","onPaymentAuthorized","completePayment","status","STATUS_FAILURE","tokenize","payment","first_name","givenName","last_name","familyName","extractAddressLines","addressLines","phoneNumber","emailAddress","nonce","STATUS_SUCCESS","isEmpty","createSession","onvalidatemerchant","onpaymentmethodselected","onpaymentauthorized","onshippingcontactselected","onshippingmethodselected","handleClick","begin","alert","getSettings","loadApplePay","authorization","getClientToken","ApplePayContainer","setApplePayInstance","ApplePayButton","style","styles","getButtonStyle","registerExpressPaymentMethod","canMakePayment","client","window","canMakePayments","canMakePaymentsWithActiveCard","merchantIdentifier","edit","supports","features","items","forEach","item","includes","options","shippingPackage","idx","rates","shipping_rates","map","rate","txt","document","createElement","innerHTML","getShippingOptionId","rate_id","price","currency_minor_unit","dispatch","callback","priority","action","ACTIONS","ADD_ACTION","id","uniqueId","REMOVE_ACTION","emittFilter","handlers","events","sortedEvents","values","sort","b","console","log","delete","PaymentMethodDataContext","createContext","onSubmit","setExpressPaymentError","setClient","paymentMethodNonce","useReducer","actionReducer","eventHandlers","useActionEmitter","currentEventHandlers","paymentHandler","useNoticeHandler","removeNotice","setPaymentHandler","handler","loadClient","paymentMethodDataContext","fraud","enabled","threeDSecureEnabled","Provider","useContext","CustomForm","config","getCustomFormConfig","breakpoint","fieldKeys","hostedFieldInstance","setHostedFieldsInstance","setFields","containerElement","setContainerElement","cardBrand","setCardBrand","fieldOrder","assertFieldsValid","reduce","acc","prop","setFieldContainer","field","addClassToFields","classList","add","billingAddress","address_1","streetAddress","payload","details","invalidFieldKeys","useBreakpointWidth","clientInstance","on","cards","emittedBy","isValid","nextField","focus","cloneElement","setFieldOrder","CardIcon","src","getIconSrc","InvalidCustomForm","sprintf","forms","assertValidConfig","assertValidFormId","Error","assertConfigHasProperties","missingParams","join","BootstrapForm","CardNumber","CardExpirationDate","CardCVV","registerCustomForm","DropinForm","setDropinInstance","clientToken","locale","setError","dropinInstance","onChange","CreditCardComponent","dropinEnabled","DropinContainer","HostedFieldsContainer","handlePaymentProcessing","requestPaymentMethod","registerPaymentMethod","ariaLabel","savedTokenComponent","SavedTokenProvider","showSavedCards","showSaveOption","canShowSavedCard","unit","formatPrice","currency_code","defaultSelectedOptionId","selected","paymentsClient","setPaymentsClient","environment","merchantInfo","merchantName","merchantId","paymentDataCallbacks","transactionState","onPaymentDataChanged","shippingOptionData","shippingOptionsEqual","shippingAddressEqual","newTransactionInfo","totalPriceStatus","totalPrice","totalPriceLabel","displayItems","getDisplayItems","newShippingOptionParameters","shippingOptions","getShippingOptions","reason","intent","google","payments","api","PaymentsClient","useHandleTokenization","onClose","googlePayInstance","payloadData","paymentDataRequestArgs","transactionInfo","emailRequired","callbackIntents","shippingAddressRequired","shippingAddressParameters","shippingOptionRequired","shippingOptionParameters","paymentDataRequest","createPaymentDataRequest","allowedPaymentMethods","parameters","assuranceDetailsRequired","billingAddressRequired","billingAddressParameters","format","phoneNumberRequired","loadPaymentData","extractFullName","address1","address_2","address2","parseResponse","statusCode","canPay","GooglePayContainer","setGooglePayInstance","useExpressBreakpointWidth","useCreatePaymentsClient","removeButton","lastChild","removeChild","googlePayVersion","googleMerchantId","button","createButton","append","isReadyToPay","apiVersion","apiVersionMinor","innerWidth","windowWidth","setWindowWidth","minWidth","getFromCache","storeInCache","clientWidth","remove","onWindowResize","addEventListener","removeEventListener","element","setElement","parentNode","dataCollector","setDataCollector","kount","deviceData","setNotice","getErrorMessage","onShippingRateSuccess","onShippingRateFail","onShippingRateSelectSuccess","handleShippingChange","isSelectingRate","shippingRatesLoading","filter","Boolean","pop","handleShippingRateFail","addPaymentEventHandler","execute","addShippingMethodHandler","addShippingAddressHandler","unsubscribeShippingRateSuccess","unsubscribeShippingRateSelectSuccess","unsubscribeShippingRateFail","processingResponse","paymentDetails","braintreeErrorMessage","ERROR","vaulted","setInstance","verifyCard","bin","surname","extendedAddress","region","countryCodeAlpha2","additionalInformation","shippingGivenName","shippingSurname","onLookupComplete","useLoadPayPal","paypalCheckoutInstance","flow","partnerCode","paypal","setPayPal","JSON","parse","atob","clientId","commit","vault","dataAttributes","loadPayPalSDK","usePayPalOptions","paymentData","incompleteBilling","baseStyle","FUNDING","PAYPAL","PAYLATER","getFormattedShippingOptions","onShippingChange","actions","selectedShippingOption","shippingDataEqual","patch","getCartTotalItem","order","sources","fundingSource","option","onError","onApprove","tokenizePayment","line1","line2","recipientName","firstName","lastName","cartContainsSubscription","createOrder","createPayment","enableShippingAddress","shippingAddressEditable","onCancel","createBillingAgreement","shipping_address","selected_shipping_option","shippingOptionId","postal_code","country_code","isShippingOptionEqual","Buttons","isEligible","PayPalContainer","setPayPalCheckoutInstance","isPayPalButton","setIsPayPalButton","paypalButton","merchantAccountId","getMerchantAccount","driver","React","ReactDOM","PayPalButton","BUTTON","wcBraintreeData","getSetting","errorMessages","SHIPPING_OPTION_REGEX","merchantAccounts","SUCCESS","msg","getCacheKey","exp","Math","floor","getTime","sessionStorage","setItem","stringify","defaultValue","getItem","deleteFromCache","removeItem","getCurrency","prefix","suffix","decimalSeparator","thousandSeparator","parseInt","fractional","index","replace","substr","match","RegExp","packageId","rateId","packageIdx","split","lines","hasSubscription","venmoInstance","loadVenmo","allowNewBrowserTab","VenmoComponent","setVenmoInstance","VenmoButton","placeOrderButtonLabel","isBrowserSupported","hasOwn","classNames","argType","inner","default"],"mappings":"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","file":"commons.js","sourcesContent":["function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nvar isNativeReflectConstruct = require(\"./isNativeReflectConstruct\");\n\nfunction _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    module.exports = _construct = Reflect.construct;\n  } else {\n    module.exports = _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nmodule.exports = _construct;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","function _extends() {\n  module.exports = _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nmodule.exports = _extends;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","function _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nmodule.exports = _interopRequireDefault;","function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}\n\nmodule.exports = _isNativeFunction;","function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nmodule.exports = _isNativeReflectConstruct;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;","var objectWithoutPropertiesLoose = require(\"./objectWithoutPropertiesLoose\");\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutProperties;","function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutPropertiesLoose;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","var getPrototypeOf = require(\"./getPrototypeOf\");\n\nvar setPrototypeOf = require(\"./setPrototypeOf\");\n\nvar isNativeFunction = require(\"./isNativeFunction\");\n\nvar construct = require(\"./construct\");\n\nfunction _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  module.exports = _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}\n\nmodule.exports = _wrapNativeSuper;","import {Component} from '@wordpress/element';\r\n\r\nclass ErrorBoundary extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {hasError: false, error: null, errorInfo: null};\r\n    }\r\n\r\n    componentDidCatch(error, errorInfo) {\r\n        this.setState({\r\n            hasError: true,\r\n            error,\r\n            errorInfo\r\n        })\r\n    }\r\n\r\n    render() {\r\n        if (this.state.hasError) {\r\n            return (\r\n                <>\r\n                    {this.state.error &&\r\n                    <div className='wc-braintree-blocks__error'>{this.state.error.toString()}</div>}\r\n                    {this.state.errorInfo &&\r\n                    <div className='wc-braintree-blocks__error'>{this.state.errorInfo.componentStack}</div>}\r\n                </>\r\n            )\r\n        }\r\n        return this.props.children;\r\n    }\r\n}\r\n\r\nexport default ErrorBoundary;","export * from './notice';\r\nexport * from './payment-method';\r\nexport * from './payment-method-label';\r\nexport * from './saved-token-component';","import classNames from \"classnames\";\r\nimport {Notice as WordpressNotice} from '@wordpress/components';\r\n\r\nexport const Notice = ({notice, onRemove}) => {\r\n    const classes = classNames(`wc-braintree-blocks__notice ${notice.type}`);\r\n    return (\r\n        <WordpressNotice\r\n            key={`notice-${notice.type}`}\r\n            className={classes}\r\n            onRemove={() => {\r\n                if (notice.isDismissible) {\r\n                    onRemove();\r\n                }\r\n            }} {...notice}>\r\n            {notice.message}\r\n        </WordpressNotice>\r\n    )\r\n}\r\n\r\nexport default Notice;","export const PaymentMethodLabel = ({title, paymentMethod, components, icon = []}) => {\r\n    const {PaymentMethodLabel: Label, PaymentMethodIcons: Icons} = components;\r\n    if (!Array.isArray(icon)) {\r\n        icon = [icon];\r\n    }\r\n    return (\r\n        <span className={'wc-braintree-blocks-paymentMethod__label'}>\r\n            <Label text={title}/>\r\n            <Icons icons={icon} align='left'/>\r\n        </span>\r\n    )\r\n}\r\n\r\nexport default PaymentMethodLabel;","import {useRef, useState, useEffect} from '@wordpress/element';\r\nimport {PaymentMethodDataProvider} from '../../payment-methods/context';\r\nimport {useProcessPayment, useProcessPaymentFailure} from \"../../payment-methods/hooks\";\r\n\r\nexport const PaymentMethod = ({content, description = '', icons, ...props}) => {\r\n    const el = useRef();\r\n    const [container, setContainer] = useState(null);\r\n    const Content = content;\r\n    useEffect(() => {\r\n        if (el.current) {\r\n            setContainer(el.current);\r\n        }\r\n    }, []);\r\n    return (\r\n        <div ref={el} className={\"wc-braintree-blocks-payment-method__container\"}>\r\n            {description &&\r\n            <div className=\"wc-braintree-blocks-payment-method__description\">\r\n                {description}\r\n            </div>}\r\n            <PaymentMethodDataProvider container={container} {...props}>\r\n                <PaymentMethodProviderContainer {...props}>\r\n                    <Content {...props}/>\r\n                </PaymentMethodProviderContainer>\r\n            </PaymentMethodDataProvider>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst PaymentMethodProviderContainer = (\r\n    {\r\n        children,\r\n        name,\r\n        billing,\r\n        shippingData,\r\n        eventRegistration,\r\n        emitResponse,\r\n        activePaymentMethod,\r\n        isExpress = false,\r\n        advancedFraudOptions = {}\r\n    }) => {\r\n    const {onPaymentProcessing, onCheckoutAfterProcessingWithError} = eventRegistration;\r\n    const {responseTypes, noticeContexts} = emitResponse;\r\n\r\n    useProcessPayment({\r\n        onPaymentProcessing,\r\n        responseTypes,\r\n        name,\r\n        billing,\r\n        shippingData,\r\n        activePaymentMethod,\r\n        advancedFraudOptions\r\n    });\r\n\r\n    useProcessPaymentFailure({\r\n        event: onCheckoutAfterProcessingWithError,\r\n        responseTypes,\r\n        messageContext: isExpress ? noticeContexts.EXPRESS_PAYMENTS : null\r\n    });\r\n    return children;\r\n}\r\n\r\nexport default PaymentMethod;","import {useEffect, useRef, useCallback} from '@wordpress/element';\r\nimport {ensureSuccessResponse, ensureErrorResponse, BraintreeError} from \"../../payment-methods/utils\";\r\nimport {useThreeDSecure, useProcessPaymentFailure, useDeviceData} from \"../../payment-methods/hooks\";\r\nimport apiFetch from '@wordpress/api-fetch';\r\nimport {usePaymentMethodDataContext, PaymentMethodDataProvider} from \"../../payment-methods/context\";\r\n\r\nexport const SavedTokenProvider = (props) => {\r\n    return (\r\n        <PaymentMethodDataProvider {...{...props}}>\r\n            <SavedTokenComponent {...{...props}}/>\r\n        </PaymentMethodDataProvider>\r\n    )\r\n}\r\nexport const SavedTokenComponent = (\r\n    {\r\n        name,\r\n        vaultedThreeDSecure = false,\r\n        token,\r\n        eventRegistration,\r\n        billing,\r\n        shippingData,\r\n        emitResponse\r\n    }) => {\r\n    const {responseTypes} = emitResponse;\r\n    const {onPaymentProcessing, onCheckoutAfterProcessingWithError} = eventRegistration;\r\n    const currentData = useRef({billing, shippingData});\r\n    const {doPaymentDataFilter} = usePaymentMethodDataContext();\r\n    useDeviceData();\r\n    useThreeDSecure(vaultedThreeDSecure);\r\n    useProcessPaymentFailure({\r\n        event: onCheckoutAfterProcessingWithError,\r\n        responseTypes\r\n    });\r\n\r\n    useEffect(() => {\r\n        currentData.current = {name, billing, shippingData};\r\n    });\r\n\r\n    const fetchTokenNonce = useCallback(async (token_id) => {\r\n        try {\r\n            let result = await apiFetch({\r\n                path: '/wc-braintree/v1/3ds/vaulted_nonce',\r\n                method: 'POST',\r\n                data: {token_id, version: 2}\r\n            });\r\n            return result;\r\n        } catch (error) {\r\n\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const unsubscribe = onPaymentProcessing(async () => {\r\n            if (vaultedThreeDSecure) {\r\n                try {\r\n                    let result = await fetchTokenNonce(token);\r\n                    if (!result.success) {\r\n                        throw new BraintreeError({message: result.message});\r\n                    }\r\n                    result = await doPaymentDataFilter({\r\n                        meta: {\r\n                            paymentMethodData: {\r\n                                [`${name}_3ds_nonce_key`]: 'true'\r\n                            }\r\n                        }\r\n                    }, {...currentData.current, ...{result: result.data}});\r\n                    return ensureSuccessResponse(responseTypes, result);\r\n                } catch (error) {\r\n                    return ensureErrorResponse(responseTypes, error);\r\n                }\r\n            }\r\n            return null;\r\n        });\r\n        return () => unsubscribe();\r\n    }, [\r\n        onPaymentProcessing,\r\n        vaultedThreeDSecure,\r\n        token,\r\n        name,\r\n        responseTypes\r\n    ]);\r\n    return null;\r\n}\r\n\r\nexport default SavedTokenComponent;","export * from './use-create-payment-request';\r\nexport * from './use-create-session';","import {useEffect, useMemo, useRef, useCallback} from '@wordpress/element';\r\nimport {removeNumberPrecision} from \"../../utils\";\r\nimport {formatLineItems, formatShippingMethods} from \"../utils\";\r\n\r\nexport const useCreatePaymentRequest = (\r\n    {\r\n        applePayInstance,\r\n        billing,\r\n        shippingData,\r\n        getData\r\n    }) => {\r\n    const currentData = useRef({});\r\n\r\n    useEffect(() => {\r\n        currentData.current.billing = billing;\r\n        currentData.current.shippingData = shippingData;\r\n    }, [billing, shippingData]);\r\n\r\n    const request = useMemo(() => {\r\n        if (applePayInstance) {\r\n            const {cartTotal, currency, cartTotalItems, billingData} = currentData.current.billing;\r\n            const {needsShipping, shippingRates} = currentData.current.shippingData;\r\n            const request = {\r\n                total: {\r\n                    label: getData('displayName'),\r\n                    type: 'final',\r\n                    amount: removeNumberPrecision(cartTotal.value, currency.minorUnit).toString()\r\n                },\r\n                lineItems: formatLineItems(cartTotalItems, currency.minorUnit),\r\n                currencyCode: currency.code,\r\n                countryCode: getData('countryCode'),\r\n                requiredBillingContactFields: ['postalAddress'],\r\n                requiredShippingContactFields: (() => {\r\n                    let fields = needsShipping ? ['postalAddress'] : [];\r\n                    if (!billingData.email) {\r\n                        fields = [...fields, 'email'];\r\n                    }\r\n                    if (!billingData.phone) {\r\n                        fields = [...fields, 'phone'];\r\n                    }\r\n                    return fields;\r\n                })()\r\n            }\r\n            if (needsShipping) {\r\n                request.shippingMethods = formatShippingMethods(shippingRates);\r\n            }\r\n            const paymentRequest = applePayInstance.createPaymentRequest(request);\r\n            return paymentRequest;\r\n        }\r\n        return null;\r\n    }, [applePayInstance]);\r\n    return request;\r\n}\r\n\r\nexport default useCreatePaymentRequest;","import {useEffect, useState, useRef, useCallback} from '@wordpress/element';\r\nimport {__} from '@wordpress/i18n';\r\nimport {range} from 'lodash';\r\nimport {usePaymentMethodDataContext} from \"../../context\";\r\nimport {usePaymentEventsHandler} from \"../../hooks\";\r\nimport apiFetch from '@wordpress/api-fetch';\r\nimport {isEqual, isEmpty} from 'lodash';\r\nimport {formatLineItems, formatShippingMethods} from \"../utils\";\r\nimport {\r\n    removeNumberPrecision,\r\n    extractSelectedShippingOption,\r\n    getSelectedShippingOptionId,\r\n    extractAddressLines\r\n} from \"../../utils\";\r\n\r\nexport const useCreateSession = (\r\n    {\r\n        applePayInstance,\r\n        billing,\r\n        shippingData,\r\n        paymentRequest,\r\n        eventRegistration,\r\n        onClick,\r\n        getData\r\n    }) => {\r\n    const {addShippingHandler} = usePaymentEventsHandler({\r\n        billing,\r\n        shippingData,\r\n        eventRegistration\r\n    });\r\n    const {setPaymentMethodNonce, onPaymentDataFilter, notice: {addNotice}} = usePaymentMethodDataContext();\r\n    const applePayData = useRef({});\r\n    const currentData = useRef({\r\n        billing,\r\n        shippingData,\r\n        onClick,\r\n        addNotice,\r\n        addShippingHandler,\r\n        setPaymentMethodNonce,\r\n        onPaymentDataFilter\r\n    });\r\n\r\n    const getApplePayVersion = useCallback(() => {\r\n        // always check support from highest version first\r\n        for (let version of range(10, 2, -1)) {\r\n            if (ApplePaySession.supportsVersion(version)) {\r\n                return version;\r\n            }\r\n        }\r\n        return 3;\r\n    }, []);\r\n\r\n    const onValidateMerchant = useCallback((event) => {\r\n        const {session} = currentData.current;\r\n        applePayInstance.performValidation({\r\n            validationURL: event.validationURL,\r\n            displayName: getData('displayName')\r\n        }).then(merchantSession => {\r\n            session.completeMerchantValidation(merchantSession);\r\n        }).catch(error => {\r\n            session.abort();\r\n            addNotice(error);\r\n        })\r\n    }, [applePayInstance, addNotice]);\r\n\r\n    const onPaymentMethodSelected = useCallback((event) => {\r\n        // update the cart billing address info\r\n        const {paymentMethod} = event;\r\n        const {session, addNotice} = currentData.current;\r\n        let address = null;\r\n        if (paymentMethod.billingContact) {\r\n            address = {\r\n                country: paymentMethod.billingContact?.countryCode || '',\r\n                state: paymentMethod.billingContact?.administrativeArea || '',\r\n                postcode: paymentMethod.billingContact?.postalCode || '',\r\n                city: paymentMethod.billingContact?.locality || ''\r\n            }\r\n        }\r\n        apiFetch({\r\n            url: getData('routes').paymentMethod,\r\n            method: 'POST',\r\n            data: {\r\n                address\r\n            }\r\n        }).then(response => {\r\n            if (response.code) {\r\n                session.abort();\r\n                addNotice(response.messages);\r\n            } else {\r\n                session.completePaymentMethodSelection(response.data);\r\n            }\r\n        }).catch((xhr) => {\r\n\r\n        });\r\n    }, []);\r\n\r\n    const onShippingContactSelected = useCallback((event) => {\r\n        const {shippingContact} = event;\r\n        const {shippingData, addShippingHandler} = currentData.current;\r\n        const {shippingAddress, setShippingAddress} = shippingData;\r\n        const {country, state, city, postcode} = shippingAddress;\r\n        const newAddress = {\r\n            country: shippingContact?.countryCode.toUpperCase(),\r\n            state: shippingContact?.administrativeArea.toUpperCase(),\r\n            city: shippingContact.locality,\r\n            postcode: shippingContact.postalCode\r\n        }\r\n        const addressEqual = isEqual({country, state, city, postcode}, newAddress);\r\n        addShippingHandler((success, {billing, shippingData}) => {\r\n            const {session} = currentData.current;\r\n            const {cartTotal, cartTotalItems, currency} = billing;\r\n            const {shippingRates, selectedRates} = shippingData;\r\n            const updateData = {\r\n                newTotal: {\r\n                    label: getData('displayName'),\r\n                    type: 'final',\r\n                    amount: removeNumberPrecision(cartTotal.value, currency.minorUnit).toString()\r\n                },\r\n                newLineItems: formatLineItems(cartTotalItems, currency.minorUnit),\r\n                newShippingMethods: formatShippingMethods(shippingRates)\r\n            };\r\n            currentData.current.errors = [];\r\n            if (!success) {\r\n                updateData.newShippingMethods = [{\r\n                    identifier: '0:error:1',\r\n                    label: __('No shipping methods', 'woo-payment-gateway'),\r\n                    detail: __('There are no shipping options available for the selected address.', 'woo-payment-gateway'),\r\n                    amount: '0.00'\r\n                }];\r\n                currentData.current.errors = [new ApplePayError('addressUnserviceable')];\r\n            }\r\n            session.completeShippingContactSelection(updateData);\r\n        }, addressEqual);\r\n        setShippingAddress({...shippingAddress, ...newAddress});\r\n    }, []);\r\n\r\n    const onShippingMethodSelected = useCallback((event) => {\r\n        const {shippingMethod} = event;\r\n        const {session, billing, shippingData, addNotice} = currentData.current;\r\n        const {cartTotal} = billing;\r\n        const {setSelectedRates, selectedRates} = shippingData;\r\n        const selectedRate = getSelectedShippingOptionId(selectedRates);\r\n        const isRateEqual = selectedRate == shippingMethod.identifier;\r\n        setSelectedRates(...extractSelectedShippingOption(shippingMethod.identifier));\r\n        addShippingHandler((success, {billing}) => {\r\n            const {currency, cartTotalItems} = billing;\r\n            if (success) {\r\n                session.completeShippingMethodSelection({\r\n                    newTotal: {\r\n                        label: getData('displayName'),\r\n                        type: 'final',\r\n                        amount: removeNumberPrecision(cartTotal.value, currency.minorUnit).toString()\r\n                    },\r\n                    newLineItems: formatLineItems(cartTotalItems, currency.minorUnit)\r\n                });\r\n            } else {\r\n                session.abort();\r\n                addNotice(__('There was an error updating your cart totals.', 'woo-payment-gateway'));\r\n            }\r\n        }, isRateEqual);\r\n    }, []);\r\n\r\n    const onPaymentAuthorized = useCallback((event) => {\r\n        const {session, setPaymentMethodNonce, errors = []} = currentData.current;\r\n        if (errors?.length > 0) {\r\n            session.completePayment({\r\n                status: ApplePaySession.STATUS_FAILURE,\r\n                errors\r\n            });\r\n        } else {\r\n            applePayInstance.tokenize({\r\n                token: event?.payment?.token\r\n            }).then(response => {\r\n                const {shippingContact = null, billingContact = null} = event.payment;\r\n                applePayData.current.billingData = {};\r\n                if (shippingContact) {\r\n                    if (currentData.current.shippingData.needsShipping) {\r\n                        applePayData.current.shippingAddress = {\r\n                            first_name: shippingContact?.givenName,\r\n                            last_name: shippingContact?.familyName,\r\n                            city: shippingContact?.locality,\r\n                            state: shippingContact?.administrativeArea,\r\n                            postcode: shippingContact?.postalCode,\r\n                            country: shippingContact?.countryCode,\r\n                            ...extractAddressLines(shippingContact?.addressLines || [])\r\n                        }\r\n                    }\r\n                    if (shippingContact?.phoneNumber) {\r\n                        applePayData.current.billingData.phone = shippingContact?.phoneNumber;\r\n                    }\r\n                    if (shippingContact?.emailAddress) {\r\n                        applePayData.current.billingData.email = shippingContact?.emailAddress;\r\n                    }\r\n                }\r\n                if (billingContact) {\r\n                    applePayData.current.billingData = {\r\n                        first_name: billingContact?.givenName,\r\n                        last_name: billingContact?.familyName,\r\n                        city: billingContact?.locality,\r\n                        state: billingContact?.administrativeArea,\r\n                        postcode: billingContact?.postalCode,\r\n                        country: billingContact?.countryCode,\r\n                        ...extractAddressLines(billingContact?.addressLines || ''),\r\n                        ...applePayData.current.billingData\r\n                    }\r\n                }\r\n                setPaymentMethodNonce(response.nonce);\r\n                session.completePayment(ApplePaySession.STATUS_SUCCESS);\r\n            }).catch(error => {\r\n                session.completePayment(ApplePaySession.STATUS_FAILURE);\r\n            })\r\n        }\r\n    }, [applePayInstance]);\r\n\r\n    useEffect(() => {\r\n        currentData.current = {\r\n            ...currentData.current,\r\n            billing,\r\n            shippingData,\r\n            onClick,\r\n            addNotice,\r\n            addShippingHandler,\r\n            setPaymentMethodNonce\r\n        };\r\n    }, [\r\n        billing,\r\n        shippingData\r\n    ]);\r\n\r\n    useEffect(() => {\r\n        const unsubscribe = onPaymentDataFilter((data, {billing, shippingData}) => {\r\n            if (!isEmpty(applePayData.current?.billingData)) {\r\n                data.meta.billingData = {...billing.billingData, ...applePayData.current.billingData};\r\n            }\r\n            if (!isEmpty(applePayData.current?.shippingAddress)) {\r\n                data.meta.shippingData = {\r\n                    address: {...shippingData.shippingAddress, ...applePayData.current.shippingAddress}\r\n                }\r\n            }\r\n            return data;\r\n        });\r\n        return () => unsubscribe();\r\n    }, [onPaymentDataFilter]);\r\n\r\n    const createSession = useCallback(() => {\r\n        const {shippingData} = currentData.current;\r\n        const session = new ApplePaySession(getApplePayVersion(), paymentRequest);\r\n        session.onvalidatemerchant = onValidateMerchant;\r\n        session.onpaymentmethodselected = onPaymentMethodSelected;\r\n        session.onpaymentauthorized = onPaymentAuthorized;\r\n        if (shippingData.needsShipping) {\r\n            session.onshippingcontactselected = onShippingContactSelected;\r\n            session.onshippingmethodselected = onShippingMethodSelected;\r\n        }\r\n        currentData.current.session = session;\r\n        return session;\r\n    }, [\r\n        applePayInstance,\r\n        paymentRequest,\r\n        getApplePayVersion,\r\n        onValidateMerchant,\r\n        onPaymentMethodSelected,\r\n        onPaymentAuthorized,\r\n        onShippingContactSelected,\r\n        onShippingMethodSelected\r\n    ]);\r\n\r\n    const handleClick = useCallback(() => {\r\n        currentData.current.onClick();\r\n        try {\r\n            const session = createSession();\r\n            session.begin();\r\n        } catch (error) {\r\n            alert(error);\r\n        }\r\n    }, [createSession]);\r\n\r\n    return {handleClick};\r\n}\r\n\r\nexport default useCreateSession;","import {useState, useEffect} from '@wordpress/element';\r\nimport {registerExpressPaymentMethod} from '@woocommerce/blocks-registry';\r\nimport {create as createApplePay} from '@braintree/apple-pay';\r\nimport {getSettings, getClientToken} from \"../utils\";\r\nimport {PaymentMethod} from \"../../components/payment-method\";\r\nimport {usePaymentMethodDataContext} from \"../context\";\r\nimport {useCreatePaymentRequest, useCreateSession} from \"./hooks\";\r\nimport ErrorBoundary from \"../../components/error-boundary\";\r\n\r\nconst getData = getSettings('braintree_applepay');\r\n\r\nconst loadApplePay = new Promise((resolve, reject) => {\r\n    createApplePay({\r\n        authorization: getClientToken()\r\n    }).then(instance => resolve(instance)).catch(error => reject(error));\r\n});\r\n\r\nconst Test = (props) => {\r\n    return (\r\n        <ErrorBoundary>\r\n            <ApplePayContainer {...props}/>\r\n        </ErrorBoundary>\r\n    )\r\n}\r\n\r\nconst ApplePayContainer = (\r\n    {\r\n        getData,\r\n        billing,\r\n        shippingData,\r\n        eventRegistration,\r\n        onClick\r\n    }) => {\r\n    const [applePayInstance, setApplePayInstance] = useState(null);\r\n    const {notice: {addNotice}} = usePaymentMethodDataContext();\r\n    const paymentRequest = useCreatePaymentRequest({\r\n        applePayInstance,\r\n        billing,\r\n        shippingData,\r\n        getData\r\n    });\r\n    const {handleClick} = useCreateSession({\r\n        applePayInstance,\r\n        billing,\r\n        shippingData,\r\n        paymentRequest,\r\n        eventRegistration,\r\n        onClick,\r\n        getData\r\n    });\r\n    useEffect(() => {\r\n        loadApplePay.then(instance => setApplePayInstance(instance)).catch(error => addNotice(error));\r\n    }, []);\r\n\r\n    return (\r\n        <div\r\n            className={'wc-braintree-blocks-apple-pay-button__container'}>\r\n            <ApplePayButton onClick={handleClick} type={getData('buttonType')} style={getData('buttonStyle')}/>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst ApplePayButton = ({onClick, type, style}) => {\r\n    const getButtonStyle = (style) => {\r\n        switch (style) {\r\n            case 'apple-pay-button-black':\r\n                return 'black';\r\n            case 'apple-pay-button-white':\r\n                return 'white';\r\n            case 'apple-pay-button-white-with-line':\r\n                return 'white-outline';\r\n        }\r\n    }\r\n    const styles = {\r\n        '-apple-pay-button-type': type,\r\n        '-apple-pay-button-style': getButtonStyle(style)\r\n    }\r\n    return <button\r\n        className={`wc-braintree-blocks-apple-pay__button ${style}`}\r\n        style={styles}\r\n        onClick={onClick}/>\r\n\r\n}\r\n\r\nregisterExpressPaymentMethod({\r\n    name: getData('name'),\r\n    canMakePayment: async () => {\r\n        try {\r\n            const client = loadApplePay;\r\n            if (window.ApplePaySession && ApplePaySession.canMakePayments()) {\r\n                return await ApplePaySession.canMakePaymentsWithActiveCard(client.merchantIdentifier)\r\n            }\r\n        } catch (error) {\r\n            return error;\r\n        }\r\n        return false;\r\n    },\r\n    content: <PaymentMethod content={Test}\r\n                            title={getData('title')}\r\n                            description={getData('description')}\r\n                            name={getData('name')}\r\n                            icon={getData('icon')}\r\n                            getData={getData}\r\n                            isExpress={true}/>,\r\n    edit: <PaymentMethod content={ApplePayContainer} getData={getData}/>,\r\n    supports: {\r\n        features: getData('features')\r\n    }\r\n});","import {getShippingOptionId, removeNumberPrecision} from \"../utils\";\r\n\r\nexport const formatLineItems = (lineItems, minorUnit) => {\r\n    let items = [];\r\n    const keys = ['total_tax', 'total_shipping'];\r\n    lineItems.forEach(item => {\r\n        if (0 < item.value || (item.key && keys.includes(item.key))) {\r\n            items.push({\r\n                label: item.label,\r\n                type: 'final',\r\n                amount: removeNumberPrecision(item.value, minorUnit).toString()\r\n            });\r\n        }\r\n    })\r\n    return items;\r\n}\r\n\r\nexport const formatShippingMethods = (shippingRates) => {\r\n    let options = [];\r\n    shippingRates.forEach((shippingPackage, idx) => {\r\n        let rates = shippingPackage.shipping_rates.map(rate => {\r\n            let txt = document.createElement('textarea');\r\n            txt.innerHTML = rate.name;\r\n            return {\r\n                identifier: getShippingOptionId(idx, rate.rate_id),\r\n                label: txt.value,\r\n                detail: '',\r\n                amount: removeNumberPrecision(rate.price, rate.currency_minor_unit)\r\n            }\r\n        });\r\n        options = [...options, ...rates];\r\n    });\r\n    return options;\r\n}","import {useMemo} from '@wordpress/element';\r\nimport {uniqueId} from 'lodash';\r\nimport {ACTIONS} from './action-reducer';\r\n\r\nexport const useActionEmitter = (dispatch) => {\r\n    const data = useMemo(() => ({\r\n        onPaymentDataFilter: (callback, priority = 10) => {\r\n            const action = {\r\n                action: ACTIONS.ADD_ACTION,\r\n                type: 'payment_data_filter',\r\n                id: uniqueId(),\r\n                callback,\r\n                priority\r\n            };\r\n            dispatch(action);\r\n            return () => dispatch({action: ACTIONS.REMOVE_ACTION, type: action.type, id: action.id})\r\n        }\r\n    }), [dispatch]);\r\n    return data;\r\n}\r\n\r\nexport const emittFilter = async (data, args, {handlers, type}) => {\r\n    const events = handlers[type];\r\n    const sortedEvents = Array.from(events.values()).sort((a, b) => a.priority - b.priority);\r\n    try {\r\n        for (const event of sortedEvents) {\r\n            data = await Promise.resolve(event.callback(data, args));\r\n        }\r\n    } catch (error) {\r\n        console.log(error);\r\n    }\r\n    return data;\r\n}\r\n\r\n","export const ACTIONS = {\r\n    ADD_ACTION: 'add_action',\r\n    REMOVE_ACTION: 'remove_action'\r\n}\r\n\r\nexport const actionReducer = (state = {}, {action, type, id, callback, priority = 10}) => {\r\n    const event = state[type] ? state[type] : new Map();\r\n    switch (action) {\r\n        case ACTIONS.ADD_ACTION:\r\n            event.set(id, {callback, priority});\r\n            return {...state, [type]: event};\r\n        case ACTIONS.REMOVE_ACTION:\r\n            event.delete(id);\r\n            return {...state, [type]: event};\r\n    }\r\n    return state;\r\n}","export * from './payment-context';\r\nexport * from './action-reducer';\r\nexport * from './action-emitter';","import {useState, useRef, useEffect, useCallback, createContext, useContext, useReducer} from '@wordpress/element';\r\nimport {actionReducer, useActionEmitter, emittFilter} from \"../context\";\r\nimport {loadClient} from \"../utils\";\r\nimport {useNoticeHandler, useProcessPayment, useProcessPaymentFailure} from \"../hooks\";\r\n\r\nconst PaymentMethodDataContext = createContext();\r\nexport const PaymentMethodDataProvider = (\r\n    {\r\n        children,\r\n        container,\r\n        onSubmit,\r\n        getData,\r\n        isExpress = null,\r\n        setExpressPaymentError\r\n    }) => {\r\n    const [client, setClient] = useState();\r\n    const [paymentMethodNonce, setPaymentMethodNonce] = useState(null);\r\n    const [eventHandlers, dispatch] = useReducer(actionReducer, {});\r\n    const {onPaymentDataFilter} = useActionEmitter(dispatch);\r\n    const currentEventHandlers = useRef(eventHandlers);\r\n    const currentData = useRef({onSubmit});\r\n    const paymentHandler = useRef(null);\r\n    const [notice, addNotice, removeNotice] = useNoticeHandler({isExpress, setExpressPaymentError});\r\n\r\n    const doPaymentDataFilter = useCallback(async (data, args) => {\r\n        return await emittFilter(data, args, {\r\n            handlers: currentEventHandlers.current,\r\n            type: 'payment_data_filter'\r\n        });\r\n    }, []);\r\n\r\n    const setPaymentHandler = useCallback((handler) => {\r\n        paymentHandler.current = handler;\r\n    }, []);\r\n    useEffect(() => {\r\n        currentEventHandlers.current = eventHandlers;\r\n    }, [eventHandlers]);\r\n\r\n    useEffect(() => {\r\n        loadClient.then(client => setClient(client)).catch(error => {\r\n            addNotice(error)\r\n        });\r\n    }, [addNotice]);\r\n\r\n    useEffect(() => {\r\n        currentData.current = {onSubmit};\r\n    }, [onSubmit]);\r\n\r\n    useEffect(() => {\r\n        if (paymentMethodNonce) {\r\n            currentData.current.onSubmit();\r\n        }\r\n    }, [paymentMethodNonce]);\r\n\r\n    const paymentMethodDataContext = {\r\n        container,\r\n        client,\r\n        paymentMethodNonce,\r\n        setPaymentMethodNonce,\r\n        onPaymentDataFilter,\r\n        doPaymentDataFilter,\r\n        setPaymentHandler,\r\n        onSubmit,\r\n        paymentHandler: paymentHandler.current,\r\n        notice: {\r\n            notice,\r\n            addNotice,\r\n            removeNotice\r\n        },\r\n        fraud: {\r\n            enabled: getData('advancedFraudEnabled')\r\n        },\r\n        threeDSecureEnabled: getData('threeDSecureEnabled')\r\n    };\r\n    return (\r\n        <PaymentMethodDataContext.Provider value={paymentMethodDataContext}>\r\n            {children}\r\n        </PaymentMethodDataContext.Provider>\r\n    )\r\n}\r\n\r\nexport const usePaymentMethodDataContext = () => {\r\n    return useContext(PaymentMethodDataContext);\r\n}","import {useState, useEffect, useCallback, useRef, cloneElement} from '@wordpress/element';\r\nimport {__, sprintf} from '@wordpress/i18n';\r\nimport {create} from '@braintree/hosted-fields';\r\nimport classnames from \"classnames\";\r\nimport {getCustomFormConfig} from \"./registry\";\r\nimport {useBreakpointWidth} from \"../../hooks\";\r\nimport '../custom-forms';\r\n\r\nexport const CustomForm = ({options, client, id, setPaymentHandler}) => {\r\n    const config = getCustomFormConfig(id);\r\n    const {breakpoint = 0, fields: fieldKeys = [], content: Content = null, className = ''} = config;\r\n    const [hostedFieldInstance, setHostedFieldsInstance] = useState(false);\r\n    const [fields, setFields] = useState({});\r\n    const [containerElement, setContainerElement] = useState();\r\n    const [cardBrand, setCardBrand] = useState(null);\r\n    const fieldOrder = useRef([]);\r\n    const setFieldOrder = (id) => {\r\n        if (!fieldOrder.current.includes(id)) {\r\n            fieldOrder.current.push(id);\r\n        }\r\n    }\r\n    const getIconSrc = (type) => {\r\n        for (let icon of options.icons) {\r\n            if (icon.type === type) {\r\n                return icon.src;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    const assertFieldsValid = useCallback(fields => {\r\n        const missingFields = fieldKeys.reduce((acc, prop) => {\r\n            if (!fields.hasOwnProperty(prop)) {\r\n                acc.push(prop);\r\n            }\r\n            return acc;\r\n        }, []);\r\n        return missingFields.length == 0;\r\n    }, []);\r\n    const setFieldContainer = useCallback((id) => (container) => {\r\n        if (!fields?.[id]?.container && container !== null) {\r\n            const field = {\r\n                container,\r\n                ...options.fields[id]\r\n            }\r\n            setFields({...fields, [id]: field});\r\n        }\r\n    }, [fields, setFields]);\r\n\r\n    const addClassToFields = useCallback((keys, className) => {\r\n        keys.forEach(key => {\r\n            fields?.[key]?.container.classList.add(className);\r\n        });\r\n    }, [fields]);\r\n\r\n    const paymentHandler = useCallback(({shippingData, billing}) => new Promise((resolve, reject) => {\r\n        const options = {billingAddress: {}};\r\n        if (billing?.billingData?.address_1) {\r\n            options.billingAddress.streetAddress = billing.billingData.address_1;\r\n        }\r\n        if (billing?.billingData?.postcode) {\r\n            options.billingAddress.postalCode = billing.billingData.postcode;\r\n        }\r\n        hostedFieldInstance.tokenize(options, (error, payload) => {\r\n            if (error) {\r\n                if (error.code === 'HOSTED_FIELDS_FIELDS_INVALID') {\r\n                    addClassToFields(error?.details?.invalidFieldKeys || [], 'braintree-hosted-fields-invalid');\r\n                } else if (error.code === 'HOSTED_FIELDS_FIELDS_EMPTY') {\r\n                    addClassToFields(fieldKeys, 'braintree-hosted-fields-invalid');\r\n                }\r\n                reject(error);\r\n            } else {\r\n                resolve(payload);\r\n            }\r\n        });\r\n    }), [hostedFieldInstance]);\r\n\r\n    useEffect(() => {\r\n        setPaymentHandler(paymentHandler);\r\n    }, [paymentHandler]);\r\n\r\n    useBreakpointWidth({key: id, el: containerElement, className, breakpoint});\r\n\r\n    useEffect(() => {\r\n        if (assertFieldsValid(fields)) {\r\n            client.then(clientInstance => {\r\n                create({\r\n                    client: clientInstance,\r\n                    fields,\r\n                    styles: options.styles\r\n                }).then(instance => setHostedFieldsInstance(instance)).catch(error => {\r\n\r\n                });\r\n            });\r\n        }\r\n    }, [fields]);\r\n\r\n    useEffect(() => {\r\n        if (hostedFieldInstance) {\r\n            hostedFieldInstance.on('cardTypeChange', (event) => {\r\n                if (event?.cards?.length == 1) {\r\n                    setCardBrand(event.cards[0].type);\r\n                } else {\r\n                    setCardBrand(null);\r\n                }\r\n            });\r\n            hostedFieldInstance.on('validityChange', (event) => {\r\n                const field = event.fields[event.emittedBy];\r\n                if (field.isValid) {\r\n                    const idx = fieldOrder.current.indexOf(event.emittedBy);\r\n                    if (fieldOrder.current?.[idx + 1]) {\r\n                        const nextField = fieldOrder.current[idx + 1];\r\n                        hostedFieldInstance.focus(nextField);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }, [hostedFieldInstance]);\r\n    if (!Content) {\r\n        return <InvalidCustomForm id={id}/>;\r\n    }\r\n    return (\r\n        <div ref={setContainerElement} className='wc-braintree-blocks-custom__form'>\r\n            {cloneElement(Content, {\r\n                setFieldContainer,\r\n                setFieldOrder,\r\n                CardIcon: <CardIcon type={cardBrand} src={getIconSrc(cardBrand)}/>\r\n            })}\r\n        </div>\r\n    );\r\n}\r\n\r\nconst InvalidCustomForm = ({id}) => {\r\n    return (\r\n        <div className={'wc-braintree-blocks-notice__info'}>\r\n            {sprintf(__('%s is not a supported custom form.', 'woo-payment-gateway'), id)}\r\n        </div>\r\n    );\r\n};\r\n\r\nconst CardIcon = ({type, src}) => {\r\n    if (!type) {\r\n        return null;\r\n    }\r\n    const classes = classnames('wc-braintree-blocks-current-card__icon', type);\r\n    return (\r\n        <img className={classes} src={src}/>\r\n    )\r\n}\r\n\r\nexport default CustomForm;","const forms = {};\r\n\r\nexport const registerCustomForm = (config) => {\r\n    assertValidConfig(config);\r\n    forms[config.id] = config;\r\n}\r\n\r\nexport const getCustomFormConfig = (id) => {\r\n    if (assertValidFormId(id)) {\r\n        return forms[id];\r\n    }\r\n    return {};\r\n}\r\n\r\nconst assertValidFormId = (id) => {\r\n    return forms.hasOwnProperty(id);\r\n}\r\n\r\nconst assertValidConfig = (config) => {\r\n    if (!config.id) {\r\n        throw new Error('Custom forms must have a unique ID.');\r\n    }\r\n    assertConfigHasProperties(config, ['content', 'breakpoint']);\r\n}\r\n\r\nconst assertConfigHasProperties = (config, props = []) => {\r\n    const missingParams = props.reduce((acc, prop) => {\r\n        if (!config.hasOwnProperty(prop)) {\r\n            acc.push(prop);\r\n        }\r\n        return acc;\r\n    }, []);\r\n    if (missingParams.length > 0) {\r\n        throw new TypeError(`Custom form config missing params ${missingParams.join(', ')}`);\r\n    }\r\n}","import {CardNumber, CardExpirationDate, CardCVV} from \"../../hosted-fields\";\r\nimport './style.scss';\r\n\r\nexport const BootstrapForm = (props) => {\r\n    return (\r\n        <div className='wc-braintree-blocks-bootstrap__form'>\r\n            <div className='row'>\r\n                <div className='col-md-6'>\r\n                    <div className={'form-group cardnumber-form-group'}>\r\n                        <label>{'Card Number'}</label>\r\n                        <CardNumber className={'bootstrap-input'} {...props}/>\r\n                    </div>\r\n                </div>\r\n                <div className='col-md-3'>\r\n                    <div className={'form-group'}>\r\n                        <label>{'Exp Date'}</label>\r\n                        <CardExpirationDate className={'bootstrap-input'} {...props}/>\r\n                    </div>\r\n                </div>\r\n                <div className='col-md-3'>\r\n                    <div className={'form-group'}>\r\n                        <label>{'CVV'}</label>\r\n                        <CardCVV className={'bootstrap-input'} {...props}/>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default BootstrapForm;","import {registerCustomForm} from \"../custom-form/registry\";\r\nimport BootstrapForm from './bootstrap';\r\n\r\nregisterCustomForm({\r\n    id: 'bootstrap_form',\r\n    content: <BootstrapForm/>,\r\n    breakpoint: 425,\r\n    fields: ['number', 'expirationDate', 'cvv'],\r\n    className: 'bootstrap-md'\r\n})","import {create as createDropin} from '@braintree/dropin';\r\nimport {useEffect, useState, useRef} from '@wordpress/element';\r\n\r\nexport const DropinForm = ({options, setDropinInstance}) => {\r\n    const {clientToken, locale = 'en_US'} = options;\r\n    const [error, setError] = useState(null);\r\n    const el = useRef(null);\r\n    useEffect(() => {\r\n        createDropin({\r\n            authorization: clientToken,\r\n            container: '.wc-braintree-blocks-dropin__form',\r\n            locale: locale\r\n        }, (error, dropinInstance) => {\r\n            if (error) {\r\n                setError(error?.message);\r\n            } else {\r\n                setDropinInstance(dropinInstance);\r\n            }\r\n        })\r\n    }, []);\r\n    return (\r\n        <>\r\n            {error && <div className={'wc-braintree-blocks__error'}>{error}</div>}\r\n            <div ref={el} className={'wc-braintree-blocks-dropin__form'}>\r\n\r\n            </div>\r\n        </>\r\n    )\r\n\r\n}\r\n\r\nexport default DropinForm;","import classnames from \"classnames\";\r\n\r\nexport const CardCVV = ({setFieldContainer, setFieldOrder, className}) => {\r\n    setFieldOrder('cvv');\r\n    const classes = classnames('braintree-web-hosted-field', className);\r\n    return <div ref={setFieldContainer('cvv')} id='braintree-cvv' className={classes}></div>\r\n}\r\n\r\nexport default CardCVV;","import classnames from \"classnames\";\r\n\r\nexport const CardExpirationDate = ({setFieldContainer, setFieldOrder, className}) => {\r\n    setFieldOrder('expirationDate');\r\n    const classes = classnames('braintree-web-hosted-field', className);\r\n    return (\r\n        <div ref={setFieldContainer('expirationDate')} id='braintree-exp-date'\r\n             className={classes}></div>\r\n    )\r\n}\r\n\r\nexport default CardExpirationDate;","import {useEffect, useRef} from \"@wordpress/element\";\r\nimport classnames from \"classnames\";\r\n\r\nexport const CardNumber = ({onChange, setFieldContainer, setFieldOrder, className, CardIcon}) => {\r\n    setFieldOrder('number');\r\n    const classes = classnames('braintree-web-hosted-field', className);\r\n    return (\r\n        <div ref={setFieldContainer('number')} id='braintree-number' className={classes}>\r\n            {CardIcon}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default CardNumber;","export * from './card-number';\r\nexport * from './card-expiration-date';\r\nexport * from './card-cvv';","import {useState, useEffect, useCallback} from '@wordpress/element';\r\nimport {registerPaymentMethod} from '@woocommerce/blocks-registry';\r\nimport classnames from 'classnames';\r\nimport {__} from '@wordpress/i18n';\r\nimport {getSettings, loadClient, getClientToken, canShowSavedCard} from \"../utils\";\r\nimport {PaymentMethod, PaymentMethodLabel, SavedTokenProvider, Notice} from '../../components';\r\nimport DropinForm from \"./dropin-form\";\r\nimport CustomForm from \"./custom-form\";\r\nimport {usePaymentMethodDataContext} from \"../context\";\r\n\r\nconst getData = getSettings('braintree_cc');\r\n\r\nconst CreditCardComponent = (props) => {\r\n    const {setPaymentHandler, notice} = usePaymentMethodDataContext();\r\n    const dropinEnabled = getData('dropinEnabled');\r\n    const Content = dropinEnabled ? DropinContainer : HostedFieldsContainer;\r\n    const classes = classnames('wc-braintree-card-container', {\r\n        'dropin': dropinEnabled,\r\n        'customForm': !dropinEnabled\r\n    })\r\n\r\n    return (\r\n        <>\r\n            {notice?.notice && <Notice notice={notice.notice} onRemove={notice.removeNotice}/>}\r\n            <div className={classes}>\r\n                <Content setPaymentHandler={setPaymentHandler}/>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nconst HostedFieldsContainer = (props) => {\r\n    const options = {\r\n        fields: getData('hostedFieldsOptions'),\r\n        styles: getData('hostedFieldsStyles'),\r\n        icons: getData('icons')\r\n    };\r\n    return <CustomForm options={options} client={loadClient} id={getData('customForm')} {...props}/>\r\n}\r\n\r\nconst DropinContainer = ({setPaymentHandler}) => {\r\n    const [dropinInstance, setDropinInstance] = useState(null);\r\n    const handlePaymentProcessing = useCallback(() => {\r\n        return new Promise((resolve, reject) => {\r\n            dropinInstance.requestPaymentMethod((err, payload) => {\r\n                if (err) {\r\n                    reject(err);\r\n                } else {\r\n                    resolve(payload);\r\n                }\r\n            });\r\n        })\r\n    }, [dropinInstance]);\r\n    useEffect(() => {\r\n        setPaymentHandler(handlePaymentProcessing);\r\n    }, [handlePaymentProcessing]);\r\n\r\n    const options = {\r\n        clientToken: getClientToken(),\r\n        locale: 'en_US'\r\n    }\r\n    return (\r\n        <DropinForm options={options} setDropinInstance={setDropinInstance}/>\r\n    )\r\n}\r\n\r\nregisterPaymentMethod({\r\n    name: getData('name'),\r\n    label: <PaymentMethodLabel\r\n        title={getData('title')}\r\n        paymentMethod={getData('name')}\r\n        icon={getData('icon')}/>,\r\n    ariaLabel: __('Credit Cards', 'woo-payment-gateway'),\r\n    canMakePayment: () => true,\r\n    content: <PaymentMethod content={CreditCardComponent}\r\n                            title={getData('title')}\r\n                            description={getData('description')}\r\n                            name={getData('name')}\r\n                            icon={getData('icon')}\r\n                            getData={getData}/>,\r\n    savedTokenComponent: <SavedTokenProvider getData={getData}\r\n                                             name={getData('name')}\r\n                                             vaultedThreeDSecure={getData('vaultedThreeDSecure')}/>,\r\n    edit: <PaymentMethod content={CreditCardComponent} getData={getData}/>,\r\n    supports: {\r\n        showSavedCards: getData('features').includes('tokenization'),\r\n        showSaveOption: canShowSavedCard(),\r\n        features: getData('features')\r\n    }\r\n});","import {removeNumberPrecision, formatPrice, getShippingOptionId} from \"../utils\";\r\n\r\n\r\nexport const getDisplayItems = (cartTotalItems, unit = 2) => {\r\n    let items = [];\r\n    const keys = ['total_tax', 'total_shipping'];\r\n    cartTotalItems.forEach(item => {\r\n        if (0 < item.value || (item.key && keys.includes(item.key))) {\r\n            items.push({\r\n                label: item.label,\r\n                type: 'LINE_ITEM',\r\n                price: removeNumberPrecision(item.value, unit).toString()\r\n            });\r\n        }\r\n    })\r\n    return items;\r\n}\r\n\r\nexport const getShippingOptions = (shippingRates) => {\r\n    let options = [];\r\n    shippingRates.forEach((shippingPackage, idx) => {\r\n        let rates = shippingPackage.shipping_rates.map(rate => {\r\n            let txt = document.createElement('textarea');\r\n            txt.innerHTML = rate.name;\r\n            let price = formatPrice(rate.price, rate.currency_code);\r\n            return {\r\n                id: getShippingOptionId(idx, rate.rate_id),\r\n                label: txt.value,\r\n                description: `${price}`\r\n            }\r\n        });\r\n        options = [...options, ...rates];\r\n    });\r\n    return options;\r\n}\r\n\r\nexport const getSelectedShippingOptionId = (shippingRates) => {\r\n    let defaultSelectedOptionId = '';\r\n    shippingRates.forEach((shippingPackage, idx) => {\r\n        shippingPackage.shipping_rates.forEach(rate => {\r\n            if (rate.selected) {\r\n                defaultSelectedOptionId = getShippingOptionId(idx, rate.rate_id);\r\n            }\r\n        });\r\n    });\r\n    return defaultSelectedOptionId;\r\n}","export * from './use-create-payments-client';\r\nexport * from './use-handle-tokenization';","import {useState, useEffect, useRef} from '@wordpress/element';\r\nimport {__} from '@wordpress/i18n';\r\nimport google from '@googlepay';\r\nimport {isEqual} from 'lodash';\r\nimport {usePaymentEventsHandler} from \"../../hooks\";\r\nimport {removeNumberPrecision, extractSelectedShippingOption} from \"../../utils\";\r\nimport {getDisplayItems, getSelectedShippingOptionId, getShippingOptions} from \"../helpers\";\r\n\r\nexport const useCreatePaymentsClient = ({getData, shippingData, billing, eventRegistration}) => {\r\n    const {needsShipping} = shippingData;\r\n    const [paymentsClient, setPaymentsClient] = useState(null);\r\n    const {addShippingHandler} = usePaymentEventsHandler({billing, shippingData, eventRegistration});\r\n    const currentData = useRef({billing, shippingData});\r\n    useEffect(() => {\r\n        currentData.current = {billing, shippingData};\r\n    }, [billing, shippingData]);\r\n    useEffect(() => {\r\n        const args = {\r\n            environment: getData('googleEnvironment'),\r\n            merchantInfo: {\r\n                merchantName: getData('merchantName'),\r\n                merchantId: getData('googleMerchantId')\r\n            },\r\n            paymentDataCallbacks: {\r\n                onPaymentAuthorized: () => Promise.resolve({\r\n                    transactionState: \"SUCCESS\"\r\n                })\r\n            }\r\n        }\r\n        if (needsShipping) {\r\n            args.paymentDataCallbacks.onPaymentDataChanged = (data) => {\r\n                return new Promise((resolve, reject) => {\r\n                    const {shippingAddress, shippingOptionData} = data;\r\n                    const {shippingData} = currentData.current;\r\n                    const shippingOptionId = getSelectedShippingOptionId(shippingData.shippingRates);\r\n                    const shippingOptionsEqual = shippingOptionId === shippingOptionData?.id;\r\n                    const newAddress = {\r\n                        city: shippingAddress.locality,\r\n                        state: shippingAddress.administrativeArea,\r\n                        postcode: shippingAddress.postalCode,\r\n                        country: shippingAddress.countryCode\r\n                    };\r\n                    const shippingAddressEqual = isEqual({\r\n                        city: shippingData.shippingAddress.city,\r\n                        state: shippingData.shippingAddress.state,\r\n                        postcode: shippingData.shippingAddress.postcode,\r\n                        country: shippingData.shippingAddress.country\r\n                    }, newAddress);\r\n                    addShippingHandler((success, {billing, shippingData}) => {\r\n                        const {currency, cartTotal, cartTotalItems} = billing;\r\n                        const {shippingRates} = shippingData;\r\n                        if (success) {\r\n                            resolve({\r\n                                newTransactionInfo: {\r\n                                    countryCode: getData('countryCode'),\r\n                                    currencyCode: currency.code,\r\n                                    totalPriceStatus: 'FINAL',\r\n                                    totalPrice: removeNumberPrecision(cartTotal.value, currency.minorUnit).toString(),\r\n                                    totalPriceLabel: getData('totalPriceLabel'),\r\n                                    displayItems: getDisplayItems(cartTotalItems, currency.minorUnit)\r\n                                },\r\n                                newShippingOptionParameters: {\r\n                                    shippingOptions: getShippingOptions(shippingRates),\r\n                                    defaultSelectedOptionId: getSelectedShippingOptionId(shippingRates)\r\n                                }\r\n                            });\r\n                        } else {\r\n                            resolve({\r\n                                error: {\r\n                                    reason: 'SHIPPING_ADDRESS_UNSERVICEABLE',\r\n                                    message: __('Your shipping address is not serviceable.', 'woo-payment-gateway'),\r\n                                    intent: 'SHIPPING_ADDRESS'\r\n                                }\r\n                            });\r\n                        }\r\n                    }, shippingAddressEqual && shippingOptionsEqual);\r\n                    shippingData.setShippingAddress({...shippingData.shippingAddress, ...newAddress});\r\n                    if (shippingOptionData?.id !== 'shipping_option_unselected') {\r\n                        shippingData.setSelectedRates(...extractSelectedShippingOption(shippingOptionData.id));\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        setPaymentsClient(new google.payments.api.PaymentsClient(args));\r\n    }, [\r\n        needsShipping,\r\n        addShippingHandler\r\n    ]);\r\n    return paymentsClient;\r\n}","import {useState, useRef, useCallback, useEffect} from '@wordpress/element';\r\nimport {getDisplayItems, getShippingOptions, getSelectedShippingOptionId} from \"../helpers\";\r\nimport {removeNumberPrecision, extractFullName} from \"../../utils\";\r\nimport {usePaymentMethodDataContext} from \"../../context\";\r\n\r\nexport const useHandleTokenization = (\r\n    {\r\n        getData,\r\n        onClick,\r\n        onClose,\r\n        googlePayInstance,\r\n        paymentsClient,\r\n        billing,\r\n        shippingData\r\n    }) => {\r\n    const currentData = useRef({billing, shippingData});\r\n    const payloadData = useRef({});\r\n    const {setPaymentMethodNonce, onPaymentDataFilter} = usePaymentMethodDataContext();\r\n    useEffect(() => {\r\n        currentData.current = {billing, shippingData, onClick, onClose};\r\n    }, [\r\n        onClick,\r\n        shippingData,\r\n        billing\r\n    ]);\r\n\r\n    useEffect(() => {\r\n        const unsubscribe = onPaymentDataFilter((data, {billing, shippingData}) => {\r\n            if (payloadData.current?.billingData) {\r\n                data.meta.billingData = {...billing.billingData, ...payloadData.current.billingData};\r\n                if (payloadData.current.email) {\r\n                    data.meta.billingData.email = payloadData.current.email;\r\n                }\r\n            }\r\n            if (payloadData.current?.shippingAddress) {\r\n                data.meta.shippingData = {\r\n                    address: {...shippingData.shippingAddress, ...payloadData.current.shippingAddress}\r\n                }\r\n            }\r\n            return data;\r\n        });\r\n        return () => unsubscribe();\r\n    }, [onPaymentDataFilter]);\r\n\r\n    const handleClick = useCallback(() => {\r\n        const {billing, shippingData} = currentData.current;\r\n        const {billingData, currency, cartTotal, cartTotalItems} = billing;\r\n        const {needsShipping, shippingRates} = shippingData;\r\n        currentData.current.onClick();\r\n        const paymentDataRequestArgs = {\r\n            merchantInfo: {\r\n                merchantName: getData('googleMerchantName'),\r\n                merchantId: getData('googleMerchantId')\r\n            },\r\n            transactionInfo: {\r\n                countryCode: getData('countryCode'),\r\n                currencyCode: currency.code,\r\n                totalPriceStatus: 'FINAL',\r\n                totalPrice: removeNumberPrecision(cartTotal.value, currency.minorUnit).toString(),\r\n                totalPriceLabel: getData('totalPriceLabel'),\r\n                displayItems: getDisplayItems(cartTotalItems, currency.minorUnit)\r\n            },\r\n            emailRequired: !billingData.email,\r\n            callbackIntents: ['PAYMENT_AUTHORIZATION'],\r\n            shippingAddressRequired: needsShipping\r\n        };\r\n        if (needsShipping) {\r\n            paymentDataRequestArgs.shippingAddressParameters = {};\r\n            paymentDataRequestArgs.shippingOptionRequired = true;\r\n            paymentDataRequestArgs.callbackIntents = [...paymentDataRequestArgs.callbackIntents, 'SHIPPING_ADDRESS', 'SHIPPING_OPTION'];\r\n            const shippingOptions = getShippingOptions(shippingRates);\r\n            if (shippingOptions.length) {\r\n                paymentDataRequestArgs.shippingOptionParameters = {\r\n                    shippingOptions,\r\n                    defaultSelectedOptionId: getSelectedShippingOptionId(shippingRates)\r\n                }\r\n            }\r\n        }\r\n        const paymentDataRequest = googlePayInstance.createPaymentDataRequest(paymentDataRequestArgs);\r\n        paymentDataRequest.allowedPaymentMethods[0].parameters.assuranceDetailsRequired = true;\r\n        paymentDataRequest.allowedPaymentMethods[0].parameters.billingAddressRequired = true;\r\n        paymentDataRequest.allowedPaymentMethods[0].parameters.billingAddressParameters = {\r\n            format: 'FULL',\r\n            phoneNumberRequired: true\r\n        }\r\n        paymentsClient.loadPaymentData(paymentDataRequest).then(async (payload) => {\r\n            // parse the payload\r\n            if (payload?.paymentMethodData?.info?.billingAddress) {\r\n                const address = payload.paymentMethodData.info.billingAddress;\r\n                const [first_name, last_name] = extractFullName(address.name);\r\n                payloadData.current.billingData = {\r\n                    first_name,\r\n                    last_name,\r\n                    address_1: address.address1,\r\n                    address_2: address.address2,\r\n                    city: address.locality,\r\n                    state: address.administrativeArea,\r\n                    postcode: address.postalCode,\r\n                    country: address.countryCode\r\n                }\r\n            }\r\n            if (payload.shippingAddress) {\r\n                const address = payload.shippingAddress;\r\n                const [first_name, last_name] = extractFullName(address.name);\r\n                payloadData.current.shippingAddress = {\r\n                    first_name,\r\n                    last_name,\r\n                    address_1: address.address1,\r\n                    address_2: address.address2,\r\n                    city: address.locality,\r\n                    state: address.administrativeArea,\r\n                    postcode: address.postalCode,\r\n                    country: address.countryCode\r\n                };\r\n            }\r\n            if (payload.email) {\r\n                payloadData.current.email = payload.email;\r\n            }\r\n            const data = await googlePayInstance.parseResponse(payload);\r\n            // set payment method\r\n            payloadData.current.paymentMethodNonce = data.nonce;\r\n            setPaymentMethodNonce(data.nonce);\r\n        }).catch(error => {\r\n            if (error?.statusCode === 'CANCELED') {\r\n                currentData.current.onClose();\r\n                return;\r\n            }\r\n            console.log(error);\r\n        });\r\n    }, [\r\n        paymentsClient,\r\n        googlePayInstance,\r\n        setPaymentMethodNonce\r\n    ]);\r\n    return handleClick;\r\n}\r\n\r\nexport default useHandleTokenization;","import {useState, useEffect, useRef, useCallback} from '@wordpress/element';\r\nimport {create as createGooglePay} from '@braintree/google-payment';\r\nimport {registerExpressPaymentMethod} from '@woocommerce/blocks-registry';\r\nimport {PaymentMethod, PaymentMethodLabel} from \"../../components\";\r\nimport {getSettings, getClientToken} from \"../utils\";\r\nimport google from '@googlepay';\r\nimport {useCreatePaymentsClient, useHandleTokenization} from \"./hooks\";\r\nimport {usePaymentMethodDataContext} from \"../context\";\r\nimport {useExpressBreakpointWidth} from \"../hooks\";\r\n\r\nconst getData = getSettings('braintree_googlepay');\r\nlet canPay = null;\r\nconst paymentsClient = new google.payments.api.PaymentsClient({\r\n    environment: getData('googleEnvironment'),\r\n    merchantInfo: {\r\n        merchantName: getData('googleMerchantName'),\r\n        merchantId: getData('googleMerchantId')\r\n    }\r\n});\r\nconst GooglePayContainer = ({getData, billing, shippingData, eventRegistration, onClick, onClose,}) => {\r\n    const el = useRef(null);\r\n    const [googlePayInstance, setGooglePayInstance] = useState(null);\r\n    useExpressBreakpointWidth({breakpoint: 375});\r\n    const {notice} = usePaymentMethodDataContext();\r\n    const paymentsClient = useCreatePaymentsClient({getData, billing, shippingData, eventRegistration});\r\n    const handleClick = useHandleTokenization({\r\n        getData,\r\n        onClick,\r\n        onClose,\r\n        googlePayInstance,\r\n        paymentsClient,\r\n        billing,\r\n        shippingData\r\n    });\r\n\r\n    const removeButton = useCallback((el) => {\r\n        while (el.lastChild) {\r\n            el.removeChild(el.lastChild);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        createGooglePay({\r\n            authorization: getClientToken(),\r\n            googlePayVersion: 2,\r\n            googleMerchantId: getData('googleMerchantId')\r\n        }).then(instance => {\r\n            setGooglePayInstance(instance);\r\n        }).catch(error => notice.addNotice(error));\r\n    }, []);\r\n    useEffect(() => {\r\n        if (el.current && paymentsClient) {\r\n            removeButton(el.current);\r\n            const button = paymentsClient.createButton({\r\n                ...getData('buttonOptions'), ...{\r\n                    onClick: handleClick\r\n                }\r\n            });\r\n            el.current.append(button);\r\n        }\r\n    }, [\r\n        paymentsClient,\r\n        removeButton,\r\n        handleClick\r\n    ]);\r\n    return (\r\n        <div ref={el} className={'wc-braintree-blocks-gpay-button'}>\r\n\r\n        </div>\r\n    );\r\n}\r\n\r\nregisterExpressPaymentMethod({\r\n    name: getData('name'),\r\n    canMakePayment: async () => {\r\n        if (canPay !== null) {\r\n            return canPay;\r\n        }\r\n        try {\r\n            const googlePayInstance = await createGooglePay({\r\n                authorization: getClientToken(),\r\n                googlePayVersion: 2,\r\n                googleMerchantId: getData('googleMerchantId')\r\n            });\r\n            let result = await paymentsClient.isReadyToPay({\r\n                apiVersion: 2,\r\n                apiVersionMinor: 0,\r\n                allowedPaymentMethods: googlePayInstance.createPaymentDataRequest().allowedPaymentMethods\r\n            });\r\n            if (result.result) {\r\n                canPay = true;\r\n            } else {\r\n                canPay = false;\r\n            }\r\n            return canPay;\r\n        } catch (error) {\r\n            return error;\r\n        }\r\n    },\r\n    content: <PaymentMethod content={GooglePayContainer}\r\n                            title={getData('title')}\r\n                            description={getData('description')}\r\n                            name={getData('name')}\r\n                            icon={getData('icon')}\r\n                            getData={getData}\r\n                            isExpress={true}/>,\r\n    edit: <PaymentMethod content={GooglePayContainer} getData={getData}/>,\r\n    supports: {\r\n        showSavedCards: getData('features').includes('tokenization'),\r\n        showSaveOption: true,\r\n        features: getData('features')\r\n    }\r\n});\r\n","export * from './use-process-payment';\r\nexport * from './use-three-d-secure';\r\nexport * from './use-process-payment-failure';\r\nexport * from './use-device-data';\r\nexport * from './use-notice-handler';\r\nexport * from './use-payment-events-handler';\r\nexport * from './use-breakpoint-width'","import {useEffect, useState, useRef} from '@wordpress/element';\r\nimport {getFromCache, storeInCache} from \"../utils\";\r\nimport {usePaymentMethodDataContext} from \"../context\";\r\n\r\nexport const useBreakpointWidth = (\r\n    {\r\n        key,\r\n        el,\r\n        className = '',\r\n        breakpoint = 0\r\n    }) => {\r\n    const [windowWidth, setWindowWidth] = useState(window.innerWidth);\r\n    key = `${key}:breakpoint`;\r\n    useEffect(() => {\r\n        if (el) {\r\n            let minWidth = getFromCache(key, 0);\r\n            if (breakpoint < minWidth || !minWidth) {\r\n                minWidth = breakpoint;\r\n                storeInCache(key, minWidth);\r\n            }\r\n            if (el.clientWidth < minWidth) {\r\n                el.classList.add(className);\r\n            } else {\r\n                el.classList.remove(className);\r\n            }\r\n        }\r\n    }, [el, windowWidth]);\r\n\r\n    useEffect(() => {\r\n        const onWindowResize = (e) => setWindowWidth(window.innerWidth);\r\n        window.addEventListener('resize', onWindowResize);\r\n        return () => window.removeEventListener('resize', onWindowResize);\r\n    });\r\n}\r\n\r\nexport const useExpressBreakpointWidth = (\r\n    {\r\n        breakpoint,\r\n        className = 'wc-braintree-blocks-express-sm'\r\n    }) => {\r\n    const [element, setElement] = useState(null);\r\n    const {container} = usePaymentMethodDataContext();\r\n\r\n    useEffect(() => {\r\n        if (container) {\r\n            setElement(container.parentNode?.parentNode);\r\n        }\r\n    }, [container])\r\n\r\n    useBreakpointWidth({\r\n        key: 'express',\r\n        el: element,\r\n        breakpoint,\r\n        className\r\n    })\r\n}","import {useState, useEffect} from '@wordpress/element';\r\nimport {create} from '@braintree/data-collector';\r\nimport {usePaymentMethodDataContext} from \"../context\";\r\n\r\nexport const useDeviceData = (options = {}) => {\r\n    const {client, notice, onPaymentDataFilter, fraud} = usePaymentMethodDataContext();\r\n    const enabled = fraud.enabled;\r\n    const {addNotice} = notice;\r\n    const [dataCollector, setDataCollector] = useState(null);\r\n    useEffect(() => {\r\n        if (enabled && client) {\r\n            create({\r\n                client,\r\n                kount: true, ...options\r\n            }, (error, instance) => {\r\n                if (error) {\r\n                    addNotice(error);\r\n                } else {\r\n                    setDataCollector(instance);\r\n                }\r\n            });\r\n        }\r\n    }, [enabled, client, addNotice]);\r\n\r\n    useEffect(() => {\r\n        const unsubscribe = onPaymentDataFilter((data, {name}) => {\r\n            data.meta.paymentMethodData[`${name}_device_data`] = dataCollector?.deviceData;\r\n            return data;\r\n        }, 10);\r\n        return () => unsubscribe();\r\n    }, [dataCollector, onPaymentDataFilter]);\r\n    return dataCollector;\r\n}\r\n\r\nexport default useDeviceData;","import {useState, useCallback} from '@wordpress/element';\r\nimport {getErrorMessage} from \"../utils\";\r\n\r\nexport const useNoticeHandler = ({isExpress, setExpressPaymentError}) => {\r\n    const [notice, setNotice] = useState(null);\r\n    const addNotice = useCallback((error, type = 'error', isDismissible = true) => {\r\n        if (isExpress && type == 'error') {\r\n            setExpressPaymentError(getErrorMessage(error));\r\n        } else {\r\n            setNotice({\r\n                message: getErrorMessage(error),\r\n                type,\r\n                isDismissible\r\n            });\r\n        }\r\n\r\n    }, [setNotice, isExpress, setExpressPaymentError]);\r\n    const removeNotice = useCallback(() => setNotice(null), [setNotice]);\r\n    return [\r\n        notice,\r\n        addNotice,\r\n        removeNotice\r\n    ]\r\n}\r\n\r\nexport default useNoticeHandler;","import {useEffect, useRef, useCallback, useMemo} from '@wordpress/element';\r\n\r\nexport const usePaymentEventsHandler = (\r\n    {\r\n        billing,\r\n        shippingData,\r\n        eventRegistration\r\n    }) => {\r\n    const currentData = useRef({billing, shippingData});\r\n    const {onShippingRateSuccess, onShippingRateFail, onShippingRateSelectSuccess} = eventRegistration;\r\n    const handlers = useRef(new Map([\r\n        ['shippingHandler', []],\r\n        ['shippingMethodHandler', []],\r\n        ['shippingAddressHandler', []]\r\n    ]));\r\n    useEffect(() => {\r\n        currentData.current = {billing, shippingData};\r\n    });\r\n\r\n    const hasShippingOptions = (shippingRates) => shippingRates.map(rate => rate?.shipping_rates.length > 0).filter(Boolean).length > 0;\r\n\r\n    const handleShippingChange = useCallback(async () => {\r\n        const {billing, shippingData} = currentData.current;\r\n        const handler = handlers.current.get('shippingHandler');\r\n        if (handler.length > 0 && !shippingData.isSelectingRate && !shippingData.shippingRatesLoading) {\r\n            const success = hasShippingOptions(shippingData.shippingRates);\r\n            while (handler.length) {\r\n                const callback = handler.pop();\r\n                await Promise.resolve(callback(success, {billing, shippingData}));\r\n            }\r\n        }\r\n    }, []);\r\n\r\n    const handleShippingRateFail = useCallback(() => {\r\n        const {billing, shippingData} = currentData.current;\r\n        const handler = handlers.current.get('shippingHandler');\r\n        while (handler.length) {\r\n            const callback = handler.pop();\r\n            callback(false, {billing, shippingData});\r\n        }\r\n    }, []);\r\n\r\n    const addPaymentEventHandler = useCallback(type => (callback, execute = false) => {\r\n        const handler = handlers.current.get(type);\r\n        handler.push(callback);\r\n        if (execute) {\r\n            handleShippingChange();\r\n        }\r\n    }, [\r\n        handleShippingChange,\r\n        handlers.current\r\n    ]);\r\n\r\n    const addShippingHandler = useCallback(addPaymentEventHandler('shippingHandler'), [addPaymentEventHandler]);\r\n    const addShippingMethodHandler = useCallback(addPaymentEventHandler('shippingMethodHandler'), [addPaymentEventHandler]);\r\n    const addShippingAddressHandler = useCallback(addPaymentEventHandler('shippingAddressHandler'), [addPaymentEventHandler]);\r\n\r\n    useEffect(() => {\r\n        const unsubscribeShippingRateSuccess = onShippingRateSuccess(handleShippingChange);\r\n        const unsubscribeShippingRateSelectSuccess = onShippingRateSelectSuccess(handleShippingChange);\r\n        const unsubscribeShippingRateFail = onShippingRateFail(handleShippingRateFail);\r\n        return () => {\r\n            unsubscribeShippingRateSuccess();\r\n            unsubscribeShippingRateSelectSuccess();\r\n            unsubscribeShippingRateFail();\r\n        }\r\n    }, [\r\n        onShippingRateSuccess,\r\n        onShippingRateSelectSuccess,\r\n        onShippingRateFail\r\n    ]);\r\n\r\n    return {\r\n        addShippingHandler,\r\n        addShippingMethodHandler,\r\n        addShippingAddressHandler\r\n    }\r\n}","import {useEffect} from '@wordpress/element';\r\n\r\nexport const useProcessPaymentFailure = ({event, responseTypes, messageContext = null}) => {\r\n    useEffect(() => {\r\n        const unsubscribe = event((data) => {\r\n            if (data?.processingResponse?.paymentDetails?.braintreeErrorMessage) {\r\n                const message = data.processingResponse.paymentDetails.braintreeErrorMessage;\r\n                return {\r\n                    type: responseTypes.ERROR,\r\n                    message,\r\n                    messageContext\r\n                }\r\n            }\r\n            return null;\r\n        });\r\n        return () => unsubscribe();\r\n    }, [event]);\r\n}\r\n\r\nexport default useProcessPaymentFailure;","import {useEffect, useRef} from '@wordpress/element';\r\nimport {ensureErrorResponse, ensureSuccessResponse} from \"../utils\";\r\nimport {useThreeDSecure} from \"./use-three-d-secure\";\r\nimport {useDeviceData} from \"./use-device-data\";\r\nimport {usePaymentMethodDataContext} from '../context';\r\n\r\nexport const useProcessPayment = (\r\n    {\r\n        onPaymentProcessing,\r\n        responseTypes,\r\n        name,\r\n        shippingData,\r\n        billing,\r\n        activePaymentMethod,\r\n        advancedFraudOptions = {}\r\n    }) => {\r\n    const currentData = useRef({shippingData, billing, name, activePaymentMethod});\r\n    const {paymentMethodNonce, paymentHandler, doPaymentDataFilter} = usePaymentMethodDataContext();\r\n    useThreeDSecure();\r\n    useDeviceData(advancedFraudOptions);\r\n\r\n    useEffect(() => {\r\n        currentData.current = {shippingData, billing, name, activePaymentMethod, paymentMethodNonce};\r\n    });\r\n\r\n    useEffect(() => {\r\n        const unsubscribe = onPaymentProcessing(async () => {\r\n            if (currentData.current.activePaymentMethod == currentData.current.name) {\r\n                try {\r\n                    const nonce = currentData.current?.paymentMethodNonce || '';\r\n                    let data = {meta: {paymentMethodData: {[`${name}_nonce_key`]: nonce}}}, result;\r\n                    if (paymentHandler) {\r\n                        result = await Promise.resolve(paymentHandler(currentData.current));\r\n                        if (result?.nonce) {\r\n                            data.meta.paymentMethodData[`${name}_nonce_key`] = result.nonce;\r\n                        }\r\n                    }\r\n                    result = await doPaymentDataFilter(data, {...currentData.current, ...{result}});\r\n                    return ensureSuccessResponse(responseTypes, result);\r\n                } catch (error) {\r\n                    return ensureErrorResponse(responseTypes, error);\r\n                }\r\n            }\r\n        });\r\n        return () => unsubscribe();\r\n    }, [\r\n        onPaymentProcessing,\r\n        doPaymentDataFilter,\r\n        paymentHandler\r\n    ]);\r\n}\r\n\r\nexport default useProcessPayment;","import {useState, useEffect, useCallback} from '@wordpress/element';\r\nimport {create} from '@braintree/three-d-secure';\r\nimport {removeNumberPrecision} from \"../utils\";\r\nimport {usePaymentMethodDataContext} from \"../context\";\r\n\r\nexport const useThreeDSecure = (vaulted = false) => {\r\n    const {client, notice, onPaymentDataFilter, threeDSecureEnabled} = usePaymentMethodDataContext();\r\n    const {addNotice} = notice;\r\n    const [instance, setInstance] = useState(null);\r\n    useEffect(() => {\r\n        if ((threeDSecureEnabled || vaulted) && client && !instance) {\r\n            try {\r\n                create({\r\n                    version: 2,\r\n                    client\r\n                }, (error, instance) => {\r\n                    if (!error) {\r\n                        setInstance(instance);\r\n                    } else {\r\n                        addNotice(error);\r\n                    }\r\n                });\r\n            } catch (error) {\r\n\r\n            }\r\n        }\r\n    }, [\r\n        threeDSecureEnabled,\r\n        vaulted,\r\n        client,\r\n        addNotice\r\n    ]);\r\n\r\n    useEffect(() => {\r\n        if (instance) {\r\n            const unsubscribe = onPaymentDataFilter((data, {result, name, shippingData, billing}) => {\r\n                return new Promise((resolve, reject) => {\r\n                    const {needsShipping, shippingAddress} = shippingData;\r\n                    const {billingData, cartTotal, currency} = billing;\r\n                    instance.verifyCard({\r\n                        amount: removeNumberPrecision(cartTotal.value, currency.minorUnit),\r\n                        nonce: result.nonce,\r\n                        bin: result?.details?.bin,\r\n                        email: billingData.email || '',\r\n                        billingAddress: {\r\n                            givenName: billingData.first_name,\r\n                            surname: billingData.last_name,\r\n                            phoneNumber: billingData.phone,\r\n                            streetAddress: billingData.address_1,\r\n                            extendedAddress: billingData.address_2,\r\n                            locality: billingData.city,\r\n                            region: billingData.state,\r\n                            postalCode: billingData.postcode,\r\n                            countryCodeAlpha2: billingData.country\r\n                        },\r\n                        additionalInformation: needsShipping ? {\r\n                            shippingGivenName: shippingAddress.first_name,\r\n                            shippingSurname: shippingAddress.last_name,\r\n                            shippingAddress: {\r\n                                streetAddress: shippingAddress.address_1,\r\n                                extendedAddress: shippingAddress.address_2,\r\n                                locality: shippingAddress.city,\r\n                                region: shippingAddress.state,\r\n                                postalCode: shippingAddress.postcode,\r\n                                countryCodeAlpha2: shippingAddress.country\r\n                            }\r\n                        } : {},\r\n                        onLookupComplete: (data, next) => next()\r\n                    }, (error, payload) => {\r\n                        if (error) {\r\n                            reject(error);\r\n                        } else {\r\n                            data.meta.paymentMethodData[`${name}_nonce_key`] = payload.nonce;\r\n                            resolve(data);\r\n                        }\r\n                    });\r\n                })\r\n            }, 20);\r\n            return () => unsubscribe();\r\n        }\r\n    }, [instance]);\r\n\r\n    return instance;\r\n}\r\n\r\nexport default useThreeDSecure;","export * from './use-load-paypal';\r\nexport * from './use-paypal-options';","import {useState, useEffect, useRef} from '@wordpress/element';\r\n\r\nexport const useLoadPayPal = (\r\n    {\r\n        paypalCheckoutInstance,\r\n        currency,\r\n        addNotice,\r\n        clientToken,\r\n        intent,\r\n        flow,\r\n        partnerCode\r\n    }) => {\r\n    const [paypal, setPayPal] = useState(null);\r\n    const currentData = useRef({});\r\n    useEffect(() => {\r\n        currentData.current.addNotice = addNotice;\r\n    }, [\r\n        addNotice\r\n    ]);\r\n    useEffect(() => {\r\n        if (paypalCheckoutInstance) {\r\n            clientToken = JSON.parse(window.atob(clientToken));\r\n            const args = {\r\n                'client-id': clientToken?.paypal?.clientId,\r\n                commit: true,\r\n                intent: flow === 'vault' ? 'tokenize' : intent,\r\n                currency,\r\n                vault: flow === 'vault' ? true : false,\r\n                components: 'buttons',\r\n                dataAttributes: {\r\n                    'partner-attribution-id': partnerCode\r\n                }\r\n            };\r\n            paypalCheckoutInstance.loadPayPalSDK(args).then(() => {\r\n                setPayPal(window.paypal)\r\n            }).catch(error => {\r\n                currentData.current.addNotice(error);\r\n            });\r\n        }\r\n    }, [paypalCheckoutInstance]);\r\n    return paypal;\r\n}\r\n\r\nexport default useLoadPayPal;","import {useEffect, useMemo, useCallback, useRef} from '@wordpress/element';\r\nimport {__} from '@wordpress/i18n';\r\nimport {isEqual, isEmpty} from 'lodash';\r\nimport {\r\n    extractSelectedShippingOption,\r\n    removeNumberPrecision,\r\n    getCartTotalItem,\r\n    extractFullName,\r\n    getShippingOptionId,\r\n    cartContainsSubscription\r\n} from \"../../utils\";\r\nimport {usePaymentEventsHandler} from \"../../hooks\";\r\nimport {getSelectedShippingOptionId} from \"../../googlepay/helpers\";\r\nimport {usePaymentMethodDataContext} from \"../../context\";\r\n\r\nexport const usePayPalOptions = (\r\n    {\r\n        getData,\r\n        addNotice,\r\n        paypal,\r\n        paypalCheckoutInstance,\r\n        billing,\r\n        shippingData,\r\n        eventRegistration,\r\n        emitResponse,\r\n        onClick,\r\n        onClose\r\n    }) => {\r\n    const {cartTotal, currency} = billing;\r\n    const {needsShipping} = shippingData;\r\n    const {noticeContexts, responseTypes} = emitResponse;\r\n    const currentData = useRef({billing, shippingData});\r\n    const paymentData = useRef({});\r\n    const {addShippingHandler} = usePaymentEventsHandler({billing, shippingData, eventRegistration});\r\n    const {setPaymentMethodNonce, onPaymentDataFilter, onSubmit} = usePaymentMethodDataContext();\r\n    const {onCheckoutAfterProcessingWithError} = eventRegistration;\r\n\r\n    useEffect(() => {\r\n        const unsubscribe = onCheckoutAfterProcessingWithError(() => {\r\n            if (paymentData.current.incompleteBilling) {\r\n                return {\r\n                    type: responseTypes.ERROR,\r\n                    message: __('Please complete all required billing fields below then click Place Order.', 'woo-payment-gateway'),\r\n                    messageContext: noticeContexts.EXPRESS_PAYMENTS\r\n                };\r\n            }\r\n            return null;\r\n        });\r\n        return () => unsubscribe();\r\n    }, [\r\n        onCheckoutAfterProcessingWithError,\r\n        responseTypes,\r\n        noticeContexts\r\n    ]);\r\n\r\n    const getButtonStyle = useCallback((type) => {\r\n        const baseStyle = getData('buttonStyle');\r\n        switch (type) {\r\n            case paypal.FUNDING.PAYPAL:\r\n                return baseStyle;\r\n            case paypal.FUNDING.PAYLATER:\r\n                return {...baseStyle, ...getData('bnplButtonStyle')};\r\n            default:\r\n                return baseStyle;\r\n\r\n        }\r\n    }, [paypal]);\r\n\r\n    const getFormattedShippingOptions = (shippingRates) => {\r\n        let options = [];\r\n        shippingRates.forEach((shippingPackage, idx) => {\r\n            let rates = shippingPackage.shipping_rates.map(rate => {\r\n                let txt = document.createElement('textarea');\r\n                txt.innerHTML = rate.name;\r\n                return {\r\n                    id: getShippingOptionId(idx, rate.rate_id),\r\n                    label: txt.value,\r\n                    type: 'SHIPPING',\r\n                    selected: rate.selected,\r\n                    amount: {\r\n                        value: removeNumberPrecision(rate.price, 2),\r\n                        currency_code: rate.currency_code\r\n                    }\r\n                }\r\n            });\r\n            options = [...options, ...rates];\r\n        });\r\n        return options;\r\n    };\r\n\r\n    useEffect(() => {\r\n        currentData.current = {billing, shippingData, onClick, onClose, onSubmit, addNotice};\r\n    }, [\r\n        billing,\r\n        shippingData,\r\n        onClick\r\n    ]);\r\n\r\n    useEffect(() => {\r\n        const unsubscribe = onPaymentDataFilter((data, {billing, shippingData}) => {\r\n            data.meta.paymentMethodData[`${getData('name')}_nonce_key`] = paymentData.current.nonce;\r\n            data.meta.billingData = {...billing.billingData, ...paymentData.current.billingData}\r\n            data.meta.shippingData = {\r\n                address: {...shippingData.shippingAddress, ...paymentData.current.shippingAddress}\r\n            }\r\n            return data;\r\n        }, 5);\r\n        return () => unsubscribe();\r\n    }, [onPaymentDataFilter]);\r\n\r\n    const onShippingChange = useCallback((actions, selectedShippingOption, shippingDataEqual, resolve) => (success, {billing, shippingData}) => {\r\n        const {currency, cartTotal, cartTotalItems} = billing;\r\n        const {shippingRates} = shippingData;\r\n        if (success) {\r\n            // create the patch\r\n            const patch = [{\r\n                'op': 'replace',\r\n                'path': '/purchase_units/@reference_id==\\'default\\'/amount',\r\n                'value': {\r\n                    'currency_code': currency.code,\r\n                    'value': removeNumberPrecision(cartTotal.value, 2),\r\n                    'breakdown': {\r\n                        'item_total': {\r\n                            'currency_code': currency.code,\r\n                            'value': removeNumberPrecision(getCartTotalItem('total_items', cartTotalItems), 2) +\r\n                                removeNumberPrecision(getCartTotalItem('total_fees', cartTotalItems), 2)\r\n                        },\r\n                        'shipping': {\r\n                            'currency_code': currency.code,\r\n                            'value': removeNumberPrecision(getCartTotalItem('total_shipping', cartTotalItems), 2)\r\n                        },\r\n                        'tax_total': {\r\n                            'currency_code': currency.code,\r\n                            'value': removeNumberPrecision(getCartTotalItem('total_tax', cartTotalItems), 2)\r\n                        },\r\n                        'shipping_discount': {\r\n                            'currency_code': currency.code,\r\n                            'value': removeNumberPrecision(getCartTotalItem('total_discount', cartTotalItems), 2)\r\n                        }\r\n                    }\r\n                }\r\n            }, {\r\n                'op': !selectedShippingOption ? 'add' : 'replace',\r\n                'path': '/purchase_units/@reference_id==\\'default\\'/shipping/options',\r\n                'value': getFormattedShippingOptions(shippingRates)\r\n            }];\r\n            return actions.order.patch(patch).then(() => {\r\n                resolve();\r\n                actions.resolve()\r\n            });\r\n        } else {\r\n            resolve();\r\n            return actions.reject();\r\n        }\r\n    }, []);\r\n\r\n    const options = useMemo(() => {\r\n        if (paypal && paypalCheckoutInstance) {\r\n            const options = [];\r\n            const sources = [paypal.FUNDING.PAYPAL];\r\n            if (getData('bnplEnabled')) {\r\n                sources.push(paypal.FUNDING.PAYLATER);\r\n            }\r\n            for (let fundingSource of sources) {\r\n                const option = {\r\n                    fundingSource,\r\n                    style: getButtonStyle(fundingSource),\r\n                    onError: (error) => currentData.current.addNotice(error),\r\n                    onClick: () => {\r\n                        currentData.current.onClick();\r\n                    },\r\n                    onApprove: (data, actions) => {\r\n                        return paypalCheckoutInstance.tokenizePayment(data).then(response => {\r\n                            const {billingData} = currentData.current.billing;\r\n                            const {needsShipping} = currentData.current.shippingData;\r\n                            // set shipping address\r\n                            paymentData.current = {nonce: response.nonce, billingData: {}};\r\n                            if (response?.details?.billingAddress) {\r\n                                const address = response.details.billingAddress;\r\n                                paymentData.current.billingData = {\r\n                                    address_1: address.line1,\r\n                                    address_2: address.line2,\r\n                                    city: address.city,\r\n                                    state: address.state,\r\n                                    postcode: address.postalCode,\r\n                                    country: address.countryCode\r\n                                }\r\n                            }\r\n                            if (!isEmpty(response?.details?.shippingAddress)) {\r\n                                const {shippingAddress} = response.details;\r\n                                const [first_name, last_name] = extractFullName(shippingAddress.recipientName);\r\n                                paymentData.current.shippingAddress = {\r\n                                    first_name,\r\n                                    last_name,\r\n                                    address_1: shippingAddress.line1,\r\n                                    address_2: shippingAddress.line2,\r\n                                    city: shippingAddress.city,\r\n                                    state: shippingAddress.state,\r\n                                    postcode: shippingAddress.postalCode,\r\n                                    country: shippingAddress.countryCode\r\n                                }\r\n                                if (isEmpty(paymentData.current.billingData)) {\r\n                                    paymentData.current.billingData = paymentData.current.shippingAddress;\r\n                                }\r\n                            }\r\n                            if (response.details?.phone) {\r\n                                paymentData.current.billingData.phone = response.details.phone;\r\n                            }\r\n                            if (response.details?.email) {\r\n                                paymentData.current.billingData.email = response.details.email;\r\n                            }\r\n                            if (response.details?.firstName) {\r\n                                paymentData.current.billingData.first_name = response.details.firstName;\r\n                            }\r\n                            if (response.details?.lastName) {\r\n                                paymentData.current.billingData.last_name = response.details.lastName;\r\n                            }\r\n                            if (!paymentData.current.billingData.address_1 && !billingData.address_1) {\r\n                                paymentData.current.incompleteBilling = true;\r\n                            }\r\n                            if (cartContainsSubscription() && needsShipping) {\r\n                                currentData.current.addNotice(__('Please select a shipping option then click Place Order to complete your payment.', 'woo-payment-gateway'), 'info');\r\n                            } else {\r\n                                setPaymentMethodNonce(response.nonce);\r\n                            }\r\n                        });\r\n                    },\r\n                    createOrder: () => {\r\n                        return paypalCheckoutInstance.createPayment({\r\n                            flow: cartContainsSubscription() ? 'vault' : 'checkout',\r\n                            intent: getData('intent'),\r\n                            currency: currency.code,\r\n                            displayName: getData('displayName'),\r\n                            amount: removeNumberPrecision(cartTotal.value, currency.minorUnit),\r\n                            enableShippingAddress: needsShipping,\r\n                            shippingAddressEditable: needsShipping\r\n                        }).then(id => {\r\n                            return id;\r\n                        }).catch(error => {\r\n                            console.log(error);\r\n                        })\r\n                    },\r\n                    onCancel: () => {\r\n                        currentData.current.onClose();\r\n                    }\r\n                }\r\n                if (cartContainsSubscription()) {\r\n                    option.createBillingAgreement = option.createOrder;\r\n                    delete (option.createOrder);\r\n                }\r\n                // can't update shipping options when using billing agreements.\r\n                if (needsShipping && !option.hasOwnProperty('createBillingAgreement')) {\r\n                    option.onShippingChange = (data, actions) => {\r\n                        const {shipping_address: address, selected_shipping_option} = data;\r\n                        const selectedShippingOption = selected_shipping_option?.id;\r\n                        const shippingData = currentData.current.shippingData;\r\n                        const {shippingAddress} = shippingData;\r\n                        const {city, state, postcode, country} = shippingAddress;\r\n                        const shippingOptionId = getSelectedShippingOptionId(currentData.current.shippingData.shippingRates);\r\n                        const newAddress = {\r\n                            city: address.city,\r\n                            state: address.state,\r\n                            postcode: address.postal_code,\r\n                            country: address.country_code\r\n                        }\r\n                        const isShippingOptionEqual = selectedShippingOption == null || selectedShippingOption == shippingOptionId;\r\n                        const isAddressEqual = isEqual({\r\n                            city, state, postcode, country\r\n                        }, newAddress);\r\n                        const shippingDataEqual = isAddressEqual && isShippingOptionEqual;\r\n                        if (selectedShippingOption) {\r\n                            shippingData.setSelectedRates(...extractSelectedShippingOption(selectedShippingOption));\r\n                        }\r\n                        shippingData.setShippingAddress({...shippingAddress, ...newAddress});\r\n                        return new Promise(resolve => {\r\n                            addShippingHandler(onShippingChange(actions, selected_shipping_option?.id, shippingDataEqual, resolve), shippingDataEqual);\r\n                        });\r\n                    }\r\n                }\r\n                let button = paypal.Buttons(option);\r\n                if (button.isEligible()) {\r\n                    options.push(option);\r\n                }\r\n            }\r\n            return options;\r\n        }\r\n    }, [\r\n        paypal,\r\n        paypalCheckoutInstance,\r\n        needsShipping,\r\n        onShippingChange,\r\n        addShippingHandler,\r\n        setPaymentMethodNonce\r\n    ]);\r\n    return options;\r\n}\r\n\r\nexport default usePayPalOptions;","import {useState, useEffect, useRef} from '@wordpress/element';\r\nimport {registerExpressPaymentMethod} from '@woocommerce/blocks-registry';\r\nimport {create as createPayPalCheckout} from '@braintree/paypal-checkout';\r\nimport {getClientToken, getSettings, getMerchantAccount, cartContainsSubscription} from \"../utils\";\r\nimport {Notice, PaymentMethod} from \"../../components\";\r\nimport {usePaymentMethodDataContext} from \"../context\";\r\nimport {useLoadPayPal, usePayPalOptions} from \"./hooks\";\r\nimport {useExpressBreakpointWidth} from \"../hooks\";\r\n\r\nconst getData = getSettings('braintree_paypal');\r\n\r\nconst PayPalContainer = ({billing, shippingData, eventRegistration, emitResponse, onClick, onClose}) => {\r\n    const {currency} = billing;\r\n    const {notice} = usePaymentMethodDataContext();\r\n    const {addNotice} = notice;\r\n    const [paypalCheckoutInstance, setPayPalCheckoutInstance] = useState(null);\r\n    const [isPayPalButton, setIsPayPalButton] = useState(false);\r\n    const paypalButton = useRef();\r\n    useExpressBreakpointWidth({breakpoint: 375});\r\n    const paypal = useLoadPayPal({\r\n        paypalCheckoutInstance,\r\n        currency: currency.code,\r\n        clientToken: getClientToken(),\r\n        addNotice,\r\n        intent: getData('intent'),\r\n        flow: cartContainsSubscription() ? 'vault' : 'checkout',\r\n        partnerCode: getData('partnerCode')\r\n    });\r\n    const options = usePayPalOptions({\r\n        getData,\r\n        addNotice,\r\n        paypal,\r\n        paypalCheckoutInstance,\r\n        billing,\r\n        shippingData,\r\n        eventRegistration,\r\n        emitResponse,\r\n        onClick,\r\n        onClose\r\n    })\r\n    useState(() => {\r\n        createPayPalCheckout({\r\n            authorization: getClientToken(),\r\n            merchantAccountId: getMerchantAccount(currency.code)\r\n        }).then(instance => {\r\n            setPayPalCheckoutInstance(instance)\r\n        }).catch(error => {\r\n            addNotice(error)\r\n        });\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (paypal) {\r\n            paypal.Buttons.driver(\"react\", {React, ReactDOM});\r\n            paypalButton.current = paypal.Buttons.driver(\"react\", {React, ReactDOM});\r\n            setIsPayPalButton(true);\r\n        }\r\n    }, [paypal]);\r\n    const PayPalButton = paypalButton.current;\r\n    const BUTTON = isPayPalButton && options ? options.map(option => {\r\n        return <PayPalButton key={option.fundingSource} {...option}/>\r\n    }) : null;\r\n    return (\r\n        <>\r\n            {notice?.notice && <Notice notice={notice.notice} onRemove={notice.removeNotice}/>}\r\n            {BUTTON}\r\n        </>\r\n    )\r\n}\r\n\r\nregisterExpressPaymentMethod({\r\n    name: getData('name'),\r\n    canMakePayment: () => {\r\n        return true;\r\n    },\r\n    content: <PaymentMethod content={PayPalContainer}\r\n                            title={getData('title')}\r\n                            description={getData('description')}\r\n                            name={getData('name')}\r\n                            icon={getData('icon')}\r\n                            getData={getData}\r\n                            isExpress={true}\r\n                            advancedFraudOptions={{paypal: true}}/>,\r\n    edit: <PaymentMethod content={PayPalContainer} getData={getData}/>,\r\n    supports: {\r\n        showSavedCards: getData('features').includes('tokenization'),\r\n        showSaveOption: true,\r\n        features: getData('features')\r\n    }\r\n});","import {getSetting} from '@woocommerce/settings';\r\nimport {create as createClient} from '@braintree/client';\r\nimport {getCurrency, formatPrice as wcFormatPrice} from '@woocommerce/price-format';\r\n\r\nconst wcBraintreeData = getSetting('wcBraintreeData');\r\n\r\nconst errorMessages = getSetting('wcBraintreeMessages');\r\n\r\nconst CACHE_PREFIX = 'wcBraintree:';\r\n\r\nconst SHIPPING_OPTION_REGEX = /^([\\w]+)\\:(.+)$/;\r\n\r\nexport const getSettings = (name) => {\r\n    name = `${name}_data`;\r\n    return (key) => {\r\n        if (key) {\r\n            return getSetting(name)[key];\r\n        }\r\n        return getSetting(name);\r\n    }\r\n}\r\n\r\nexport const getClientToken = () => wcBraintreeData.clientToken;\r\n\r\nexport const getMerchantAccount = (currency) => wcBraintreeData?.merchantAccounts?.[currency] ? wcBraintreeData.merchantAccounts[currency] : null\r\n\r\nexport const loadClient = new Promise((resolve, reject) => {\r\n    createClient({\r\n        authorization: wcBraintreeData.clientToken\r\n    }, (err, clientInstance) => {\r\n        if (err) {\r\n            reject(err);\r\n        } else {\r\n            resolve(clientInstance);\r\n        }\r\n    });\r\n});\r\n\r\nexport const canMakePayment = () => {\r\n    return new Promise((resolve, reject) => {\r\n        loadClient.then(() => resolve(true)).catch(error => {\r\n            console.log('Error loading client: ', error);\r\n            resolve({error});\r\n        });\r\n    });\r\n}\r\n\r\nexport const ensureSuccessResponse = (responseTypes, data = {}) => {\r\n    return {type: responseTypes.SUCCESS, ...data};\r\n}\r\n\r\nexport const ensureErrorResponse = (responseTypes, error) => {\r\n    return {type: responseTypes.ERROR, message: getErrorMessage(error)}\r\n};\r\n\r\nexport const getErrorMessage = (error) => {\r\n    let msg = error?.message;\r\n    if (typeof error == 'string') {\r\n        msg = error;\r\n    } else {\r\n        if (error.code && errorMessages[error.code]) {\r\n            msg = errorMessages[error.code];\r\n        }\r\n    }\r\n    return msg;\r\n}\r\n\r\nexport const removeNumberPrecision = (value, unit) => {\r\n    return value / 10 ** unit;\r\n}\r\n\r\nexport class BraintreeError extends Error {\r\n    constructor(error) {\r\n        super(error.message);\r\n        this.error = error;\r\n    }\r\n}\r\n\r\nconst getCacheKey = (key) => `${CACHE_PREFIX}${key}`;\r\n\r\nexport const storeInCache = (key, value) => {\r\n    const exp = Math.floor(new Date().getTime() / 1000) + (60 * 15);\r\n    if ('sessionStorage' in window) {\r\n        sessionStorage.setItem(getCacheKey(key), JSON.stringify({value, exp}));\r\n    }\r\n}\r\n\r\nexport const getFromCache = (key, defaultValue = null) => {\r\n    if ('sessionStorage' in window) {\r\n        try {\r\n            const item = JSON.parse(sessionStorage.getItem(getCacheKey(key)));\r\n            if (item) {\r\n                const {value, exp} = item;\r\n                if (Math.floor(new Date().getTime() / 1000) > exp) {\r\n                    deleteFromCache(getCacheKey(key));\r\n                } else {\r\n                    return value;\r\n                }\r\n            }\r\n        } catch (err) {\r\n        }\r\n    }\r\n    return defaultValue;\r\n}\r\n\r\nexport const deleteFromCache = (key) => {\r\n    if ('sessionStorage' in window) {\r\n        sessionStorage.removeItem(getCacheKey(key));\r\n    }\r\n}\r\n\r\nexport const formatPrice = (price, currencyCode) => {\r\n    const {prefix, suffix, decimalSeparator, minorUnit, thousandSeparator} = getCurrency(currencyCode);\r\n    if (price == '' || price === undefined) {\r\n        return price;\r\n    }\r\n\r\n    price = typeof price === 'string' ? parseInt(price, 10) : price;\r\n    price = price / 10 ** minorUnit;\r\n    price = price.toString().replace('.', decimalSeparator);\r\n    let fractional = '';\r\n    const index = price.indexOf(decimalSeparator);\r\n    if (index < 0) {\r\n        if (minorUnit > 0) {\r\n            price += `${decimalSeparator}${new Array(minorUnit + 1).join('0')}`;\r\n        }\r\n    } else {\r\n        const fractional = price.substr(index + 1);\r\n        if (fractional.length < minorUnit) {\r\n            price += new Array(minorUnit - fractional.length + 1).join('0');\r\n        }\r\n    }\r\n    // separate out price and decimals so thousands separator can be added.\r\n    const match = price.match(new RegExp(`(\\\\d+)\\\\${decimalSeparator}(\\\\d+)`));\r\n    if (match) {\r\n        ({1: price, 2: fractional} = match);\r\n    }\r\n    price = price.replace(new RegExp(`\\\\B(?=(\\\\d{3})+(?!\\\\d))`, 'g'), `${thousandSeparator}`);\r\n    price = fractional?.length > 0 ? price + decimalSeparator + fractional : price;\r\n    price = prefix + price + suffix;\r\n    return price;\r\n}\r\n\r\nexport const getShippingOptionId = (packageId, rateId) => `${packageId}:${rateId}`;\r\n\r\nexport const extractSelectedShippingOption = (id) => {\r\n    const result = id.match(SHIPPING_OPTION_REGEX);\r\n    if (result) {\r\n        const {1: packageIdx, 2: rate} = result;\r\n        return [rate, packageIdx];\r\n    }\r\n    return [];\r\n}\r\n\r\nexport const getSelectedShippingOptionId = (selectedRates) => {\r\n    for (let idx of Object.keys(selectedRates)) {\r\n        return getShippingOptionId(idx, selectedRates[idx]);\r\n    }\r\n}\r\n\r\nexport const extractFullName = (name) => {\r\n    const firstName = name.split(' ').slice(0, -1).join(' ');\r\n    const lastName = name.split(' ').pop();\r\n    return [firstName, lastName];\r\n}\r\n\r\nexport const extractAddressLines = (lines) => {\r\n    let address_1, address_2;\r\n    if (Array.isArray(lines)) {\r\n        address_1 = lines?.[0];\r\n        if (lines.length > 1) {\r\n            address_2 = lines?.[1];\r\n        }\r\n    }\r\n    return {address_1, address_2};\r\n}\r\n\r\nexport const getCartTotalItem = (key, cartTotalItems) => {\r\n    for (let item of cartTotalItems) {\r\n        if (item.key === key) {\r\n            return item.value;\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\nexport const canShowSavedCard = () => {\r\n    return !cartContainsSubscription();\r\n}\r\n\r\nexport const cartContainsSubscription = () => wcBraintreeData?.hasSubscription == true;\r\n","export * from './use-handle-tokenization';","import {useEffect, useCallback, useRef} from '@wordpress/element';\r\nimport {usePaymentMethodDataContext} from \"../../context\";\r\n\r\nexport const useHandleTokenization = ({venmoInstance, onSubmit}) => {\r\n    const paymentData = useRef(null);\r\n    const {onPaymentDataFilter, paymentMethodNonce, setPaymentMethodNonce, notice: {addNotice}} = usePaymentMethodDataContext();\r\n    const handleClick = useCallback(async () => {\r\n        try {\r\n            if (paymentMethodNonce) {\r\n                onSubmit();\r\n            } else {\r\n                const result = await venmoInstance.tokenize();\r\n                paymentData.current = {nonce: result.nonce};\r\n                setPaymentMethodNonce(result.nonce);\r\n            }\r\n        } catch (error) {\r\n            addNotice(error);\r\n        }\r\n    }, [\r\n        venmoInstance,\r\n        onSubmit,\r\n        paymentMethodNonce\r\n    ]);\r\n\r\n    useEffect(() => {\r\n        const unsubscribe = onPaymentDataFilter((data, {name}) => {\r\n            data.meta.paymentMethodData[`${name}_nonce_key`] = paymentData.current.nonce;\r\n            return data;\r\n        }, 5);\r\n        return () => unsubscribe();\r\n    }, [onPaymentDataFilter]);\r\n\r\n    return {handleClick}\r\n}\r\n\r\nexport default useHandleTokenization;","import {create as createVenmo} from '@braintree/venmo';\r\nimport {useState, useEffect} from '@wordpress/element';\r\nimport {__} from '@wordpress/i18n';\r\nimport {registerPaymentMethod} from '@woocommerce/blocks-registry';\r\nimport {Notice, PaymentMethodLabel} from \"../../components\";\r\nimport {PaymentMethod} from \"../../components\";\r\nimport {SavedTokenProvider} from \"../../components\";\r\nimport {getSettings, getClientToken} from \"../utils\";\r\nimport {usePaymentMethodDataContext} from \"../context\";\r\nimport {useHandleTokenization} from \"./hooks\";\r\n\r\nconst getData = getSettings('braintree_venmo');\r\n\r\nconst loadVenmo = new Promise((resolve, reject) => {\r\n    createVenmo({\r\n        authorization: getClientToken(),\r\n        allowNewBrowserTab: false\r\n    }).then(instance => resolve(instance)).catch(error => reject(error));\r\n});\r\n\r\nconst VenmoComponent = ({onSubmit}) => {\r\n    const {notice} = usePaymentMethodDataContext();\r\n    const [venmoInstance, setVenmoInstance] = useState(null);\r\n    const {handleClick} = useHandleTokenization({\r\n        venmoInstance,\r\n        onSubmit\r\n    });\r\n\r\n    useEffect(() => {\r\n        loadVenmo.then(instance => setVenmoInstance(instance)).catch(error => notice.addNotice(error));\r\n    }, []);\r\n    return (\r\n        <>\r\n            {notice?.notice && <Notice notice={notice.notice} onRemove={notice.removeNotice}/>}\r\n            <div className={'wc-braintree-blocks-venmo-button__container'}>\r\n                <p>{__('Complete your order with', 'woo-payment-gateway')}</p>\r\n                {venmoInstance && <VenmoButton onClick={handleClick} src={getData('buttonIcon')}/>}\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nconst VenmoButton = ({onClick, src}) => {\r\n    return (\r\n        <button className={'wc-braintree-blocks-venmo__button'} onClick={onClick}>\r\n            <img src={src}/>\r\n        </button>\r\n    )\r\n}\r\n\r\nregisterPaymentMethod({\r\n    name: getData('name'),\r\n    label: <PaymentMethodLabel\r\n        title={getData('title')}\r\n        paymentMethod={getData('name')}\r\n        icon={getData('icon')}/>,\r\n    ariaLabel: __('Venmo', 'woo-payment-gateway'),\r\n    placeOrderButtonLabel: getData('placeOrderButtonLabel'),\r\n    canMakePayment: () => new Promise((resolve, reject) => {\r\n        loadVenmo.then(instance => {\r\n            resolve(instance.isBrowserSupported());\r\n        }).catch(error => {\r\n            resolve(false)\r\n        });\r\n    }),\r\n    content: <PaymentMethod content={VenmoComponent}\r\n                            title={getData('title')}\r\n                            description={getData('description')}\r\n                            name={getData('name')}\r\n                            icon={getData('icon')}\r\n                            getData={getData}/>,\r\n    savedTokenComponent: <SavedTokenProvider getData={getData}\r\n                                             name={getData('name')}\r\n                                             vaultedThreeDSecure={getData('vaultedThreeDSecure')}/>,\r\n    edit: <PaymentMethod content={VenmoComponent} getData={getData}/>,\r\n    supports: {\r\n        showSavedCards: getData('features').includes('tokenization'),\r\n        showSaveOption: false,\r\n        features: getData('features')\r\n    }\r\n});","/*!\n  Copyright (c) 2018 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames() {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tif (arg.length) {\n\t\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\t\tif (inner) {\n\t\t\t\t\t\tclasses.push(inner);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tif (arg.toString === Object.prototype.toString) {\n\t\t\t\t\tfor (var key in arg) {\n\t\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tclasses.push(arg.toString());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n"],"sourceRoot":""}