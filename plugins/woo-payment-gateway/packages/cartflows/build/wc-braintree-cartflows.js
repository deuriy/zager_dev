!function(){var e={926:function(e){function t(e,t,n,r,o,i,c){try{var u=e[i](c),a=u.value}catch(e){return void n(e)}u.done?t(a):Promise.resolve(a).then(r,o)}e.exports=function(e){return function(){var n=this,r=arguments;return new Promise((function(o,i){var c=e.apply(n,r);function u(e){t(c,o,i,u,a,"next",e)}function a(e){t(c,o,i,u,a,"throw",e)}u(void 0)}))}}},713:function(e){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},318:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},609:function(e){"use strict";e.exports=window.jQuery},15:function(e){"use strict";e.exports=window.regeneratorRuntime},249:function(e){"use strict";e.exports=window.braintree.client},185:function(e){"use strict";e.exports=window.braintree.threeDSecure}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}!function(){var e=n(318),t=e(n(15)),r=e(n(713)),o=e(n(926)),i=e(n(249)),c=e(n(185)),u=e(n(609));function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s,d=cartflows_offer.wcBraintree,l=new Promise((function(e,t){i.default.create({authorization:d.clientToken},(function(n,r){n?(console.log(n),t()):e(r)}))})),p=new Promise(function(){var e=(0,o.default)(t.default.mark((function e(n,r){var o;return t.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l;case 2:o=e.sent,c.default.create({version:2,client:o},(function(e,t){return e?r(e):n(t)}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),w=function(){var e=(0,o.default)(t.default.mark((function e(n){var r,i;return t.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.newURL.match(/wcBraintree3DS=(.*)/))try{(i=JSON.parse(window.atob(decodeURIComponent(r[1])))).nonce?(history.pushState({},"",window.location.pathname+window.location.search),p.then((function(e){var n;e.verifyCard(f(f({amount:i.amount,nonce:i.nonce,bin:i.details.bin},null==d||null===(n=d.order)||void 0===n?void 0:n.threeDSData),{},{onLookupComplete:function(e,t){return t()}}),function(){var e=(0,o.default)(t.default.mark((function e(n,r){return t.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}b(n.message),e.next=11;break;case 4:if(!r.liabilityShifted){e.next=10;break}return e.next=7,v({nonce:r.nonce,order_id:cartflows_offer.order_id,step_id:cartflows_offer.step_id});case 7:s.click(),e.next=11;break;case 10:b(d.threeDSFailedMsg);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))):i.error&&b(i.message)}catch(e){}return e.abrupt("return",!0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(e){var t=e.nonce,n=e.order_id,r=e.step_id;return new Promise((function(e,o){var i;u.default.ajax({url:null==d?void 0:d.ajax_url,method:"POST",dataType:"json",data:{nonce:t,order_id:n,step_id:r,security:null==d||null===(i=d.security)||void 0===i?void 0:i.storeVaultedNonce}}).done((function(t){t.success&&e()})).fail((function(){o()}))}))},b=function(e){(0,u.default)("body").trigger("wcf-update-msg",[e,"wcf-payment-error"]),setTimeout((function(){(0,u.default)(document.body).trigger("wcf-hide-loader"),(0,u.default)(document.body).trigger("wcf-update-msg",[d.successMessage,"wcf-payment-success"])}),d.timeout)};window.addEventListener("hashchange",w),(0,u.default)(document.body).on("click",'a[href*="wcf-up-offer"], a[href*="wcf-down-offer"]',(function(e){s=(0,u.default)(e.currentTarget)}))}(),(window.wcBraintree=window.wcBraintree||{})["wc-braintree-cartflows"]={}}();
//# sourceMappingURL=wc-braintree-cartflows.js.map